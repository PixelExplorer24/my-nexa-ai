<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8" />
  <!-- Updated Viewport with viewport-fit=cover for safe area handling -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover, interactive-widget=resizes-content" />
  <title>NU Smart Question Bank</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Bengali:wght@300;400;500;600;700&family=Noto+Serif+Bengali:wght@400;500;600;700&display=swap" rel="stylesheet">

  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            sans: ['"Noto Sans Bengali"', 'sans-serif'],
            serif: ['"Noto Serif Bengali"', 'serif'],
          },
          colors: {
            primary: {
              50: '#fff1f2', 100: '#ffe4e6', 200: '#fecdd3', 300: '#fda4af',
              400: '#fb7185', 500: '#f43f5e', 600: '#e11d48', 700: '#be123c',
              800: '#9f1239', 900: '#881337',
            },
            accent: {
              500: '#10b981', 600: '#059669',
            }
          },
          animation: {
            'fade-in': 'fadeIn 0.5s ease-out',
            'slide-up': 'slideUp 0.4s ease-out',
            'bounce-slow': 'bounce 2s infinite',
          },
          keyframes: {
            fadeIn: { '0%': { opacity: '0' }, '100%': { opacity: '1' } },
            slideUp: { '0%': { transform: 'translateY(20px)', opacity: '0' }, '100%': { transform: 'translateY(0)', opacity: '1' } }
          }
        }
      }
    }
  </script>

  <style>
    body { font-family: 'Noto Sans Bengali', sans-serif; background-color: #fff1f2; color: #1f2937; overflow-x: hidden; }
    .font-content { font-family: 'Noto Serif Bengali', serif; }
    
    /* Header safe area handling */
    .header-safe-area {
      padding-top: env(safe-area-inset-top);
      height: auto;
    }
    
    .bg-glass { background: rgba(255, 255, 255, 0.90); backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px); border-bottom: 1px solid rgba(255, 228, 230, 0.5); }
    .mesh-bg {
      position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; z-index: -1;
      background: radial-gradient(at 0% 0%, rgba(225, 29, 72, 0.12) 0px, transparent 50%),
                  radial-gradient(at 100% 0%, rgba(244, 63, 94, 0.1) 0px, transparent 50%),
                  radial-gradient(at 100% 100%, rgba(251, 113, 133, 0.08) 0px, transparent 50%),
                  radial-gradient(at 0% 100%, rgba(225, 29, 72, 0.05) 0px, transparent 50%);
      background-size: cover;
    }
    ::-webkit-scrollbar { width: 8px; }
    ::-webkit-scrollbar-track { background: transparent; }
    ::-webkit-scrollbar-thumb { background: #fda4af; border-radius: 4px; }
    ::-webkit-scrollbar-thumb:hover { background: #fb7185; }
    .modern-input { transition: all 0.2s ease; border: 1px solid #fecdd3; background: #ffffff; }
    .modern-input:focus { border-color: #e11d48; box-shadow: 0 0 0 4px rgba(225, 29, 72, 0.1); outline: none; }
    .form-label-float { pointer-events: none; transition: all 0.2s ease; }
    .modern-input:focus ~ .form-label-float, .modern-input:not(:placeholder-shown) ~ .form-label-float {
      transform: translateY(-26px) scale(0.85); color: #e11d48; background-color: white; padding: 0 4px; margin-left: -4px;
    }
    .spinner { width: 20px; height: 20px; border-radius: 50%; border: 2px solid rgba(255,255,255,0.3); border-top-color: #fff; animation: spin 0.8s linear infinite; }
    @keyframes spin { to { transform: rotate(360deg); } }
    .dots-loader div { width: 10px; height: 10px; border-radius: 50%; background-color: #e11d48; animation: bounce 1.4s infinite ease-in-out both; }
    .dots-loader .dot1 { animation-delay: -0.32s; } .dots-loader .dot2 { animation-delay: -0.16s; }
    @keyframes bounce { 0%, 80%, 100% { transform: scale(0); } 40% { transform: scale(1); } }
    .tab-btn { position: relative; transition: color 0.3s; white-space: nowrap; }
    .tab-active::after { content: ''; position: absolute; bottom: -2px; left: 0; width: 100%; height: 3px; background: #e11d48; border-radius: 3px 3px 0 0; transform: scaleX(1); transition: transform 0.3s ease; }
    .tab-inactive::after { content: ''; position: absolute; bottom: -2px; left: 0; width: 100%; height: 3px; background: transparent; transform: scaleX(0); transition: transform 0.3s ease; }
    .answer-content { overflow: hidden; max-height: 0; transition: max-height 0.3s cubic-bezier(0, 1, 0, 1); }
    .answer-content.show { max-height: 2000px; transition: max-height 0.5s ease-in-out; }
    #toast-container { position: fixed; bottom: 24px; right: 24px; z-index: 100; display: flex; flex-direction: column; gap: 10px; }
    
    /* Modified Chat Animation Classes */
    .chat-open { opacity: 1; transform: translateY(0) scale(1); pointer-events: all; }
    .chat-closed { opacity: 0; transform: translateY(20px) scale(0.95); pointer-events: none; }
    
    /* PDF Generation specific styles */
    .card { break-inside: avoid; page-break-inside: avoid; margin-bottom: 15px; }
    
    /* Chat bubbles */
    .chat-bubble-ai strong { font-weight: 700; color: #1f2937; }
    .chat-bubble-ai ul { list-style-type: disc; padding-left: 1.2em; margin-top: 0.5em; margin-bottom: 0.5em; }
    .chat-bubble-ai li { margin-bottom: 0.25em; }
    .chat-bubble-ai p { margin-bottom: 0.5em; }
    .typing-dot { animation: typing 1.4s infinite ease-in-out both; width: 5px; height: 5px; border-radius: 50%; background-color: #9CA3AF; margin: 0 2px; }
    .typing-dot:nth-child(1) { animation-delay: -0.32s; } .typing-dot:nth-child(2) { animation-delay: -0.16s; }
    @keyframes typing { 0%, 80%, 100% { transform: scale(0); } 40% { transform: scale(1); } }

    /* Checkbox Styles */
    .checkbox-wrapper input:checked + div { background-color: #e11d48; border-color: #e11d48; }
    .checkbox-wrapper input:checked + div svg { display: block; }
  </style>
</head>

<body class="antialiased min-h-screen flex flex-col">
  <div class="mesh-bg"></div>

  <!-- Header Updated: sticky top-0 with padding-top for safe area -->
  <header class="sticky top-0 z-50 bg-glass shadow-sm transition-all duration-300 header-safe-area">
    <div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex justify-between items-center h-16 md:h-20">
        <div class="flex items-center gap-3 cursor-pointer group" onclick="location.reload()">
          <!-- Updated Logo: Book Icon matching color theme -->
          <div class="w-10 h-10 md:w-11 md:h-11 rounded-xl bg-gradient-to-br from-primary-600 to-primary-700 text-white flex items-center justify-center shadow-lg group-hover:scale-105 transition-transform shadow-primary-500/30">
            <svg class="w-6 h-6 md:w-7 md:h-7" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path></svg>
          </div>
          <div>
            <h1 class="text-xl md:text-2xl font-bold text-gray-900 tracking-tight leading-none group-hover:text-primary-700 transition-colors">Smart Question Bank</h1>
            <p class="text-xs md:text-sm text-gray-500 font-medium">AI Powered тАв Social Work</p>
          </div>
        </div>
        <div class="flex items-center gap-3 md:gap-4">
          <button id="header-saved-btn" class="relative p-2 rounded-full hover:bg-primary-50 transition text-gray-600 hover:text-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500" title="рж╕ржВрж░ржХрзНрж╖рж┐ржд ржкрзНрж░рж╢рзНржи">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.8" d="M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z"></path></svg>
            <span id="saved-count-badge" class="absolute top-1 right-0.5 min-w-[18px] h-[18px] bg-accent-600 text-white text-[10px] font-bold flex items-center justify-center rounded-full border-2 border-white shadow-sm">0</span>
          </button>
        </div>
      </div>
    </div>
  </header>

  <main class="flex-grow w-full max-w-5xl mx-auto px-4 sm:px-6 py-6 md:py-8 space-y-6">
    <div class="bg-primary-50 border border-primary-100 rounded-2xl p-4 flex items-start gap-3 shadow-sm animate-fade-in">
      <svg class="w-5 h-5 text-primary-600 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
      <p class="text-sm text-primary-800 leading-relaxed">ржПржЗ ржЕрзНржпрж╛ржкржЯрж┐ ржмрж░рзНрждржорж╛ржирзЗ рж╢рзБржзрзБржорж╛рждрзНрж░ ржЬрж╛рждрзАрзЯ ржмрж┐рж╢рзНржмржмрж┐ржжрзНржпрж╛рж▓рзЯрзЗрж░ ржЕржирж╛рж░рзНрж╕ <span class="font-bold">рж╕ржорж╛ржЬржХрж░рзНржо (Social Work)</span> ржмрж┐ржнрж╛ржЧрзЗрж░ ржЬржирзНржп ржбрж┐ржЬрж╛ржЗржи ржХрж░рж╛ рж╣рзЯрзЗржЫрзЗред</p>
    </div>

    <nav class="bg-white rounded-2xl p-1.5 shadow-sm border border-primary-100 flex gap-1 relative overflow-x-auto no-scrollbar" role="tablist">
      <button id="tab-btn-generate" class="tab-btn flex-1 py-3 px-4 text-sm md:text-base font-semibold rounded-xl text-center text-gray-500 hover:bg-primary-50 hover:text-primary-600 focus:outline-none focus:text-primary-700 transition-all tab-active">ржкрзНрж░рж╢рзНржи ржЬрзЗржирж╛рж░рзЗржЯ</button>
      <button id="tab-btn-tracker" class="tab-btn flex-1 py-3 px-4 text-sm md:text-base font-semibold rounded-xl text-center text-gray-500 hover:bg-primary-50 hover:text-primary-600 focus:outline-none focus:text-primary-700 transition-all tab-inactive">рж╕рж┐рж▓рзЗржмрж╛рж╕ ржЯрзНрж░рзНржпрж╛ржХрж╛рж░</button>
      <button id="tab-btn-collection" class="tab-btn flex-1 py-3 px-4 text-sm md:text-base font-semibold rounded-xl text-center text-gray-500 hover:bg-primary-50 hover:text-primary-600 focus:outline-none focus:text-primary-700 transition-all tab-inactive">рж╕ржВржЧрзНрж░рж╣рж╢рж╛рж▓рж╛</button>
    </nav>

    <div id="tab-content-container" class="relative min-h-[400px]">
      
      <section id="tab-content-generate" class="animate-fade-in space-y-6" aria-labelledby="tab-btn-generate">
        <div class="bg-white rounded-3xl p-6 md:p-8 shadow-lg shadow-primary-500/5 border border-white">
          <div class="flex items-center gap-3 mb-6">
            <div class="p-2 bg-primary-50 rounded-lg text-primary-600">
              <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"></path></svg>
            </div>
            <h2 class="text-xl font-bold text-gray-800">ржХрж╛рж╕рзНржЯржо ржкрзНрж░рж╢рзНржи рждрзИрж░рж┐ ржХрж░рзБржи</h2>
          </div>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div class="relative group col-span-1 md:col-span-2">
              <select id="year-select" class="modern-input w-full px-4 py-3.5 rounded-xl appearance-none text-gray-700 font-medium cursor-pointer placeholder-transparent bg-transparent z-10 relative"><option value=""> </option></select>
              <label class="form-label-float absolute left-4 top-3.5 text-gray-400 text-sm z-0">ржмрж░рзНрж╖ ржирж┐рж░рзНржмрж╛ржЪржи ржХрж░рзБржи (Year)</label>
              <div class="absolute right-4 top-1/2 transform -translate-y-1/2 pointer-events-none text-gray-400"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></div>
            </div>
            <div class="relative group md:col-span-1">
              <select id="subject-select" disabled class="modern-input w-full px-4 py-3.5 rounded-xl appearance-none text-gray-700 font-medium cursor-pointer disabled:bg-gray-50 disabled:cursor-not-allowed"><option value=""> </option></select>
              <label class="form-label-float absolute left-4 top-3.5 text-gray-400 text-sm">ржмрж┐рж╖рзЯ (Subject)</label>
              <div class="absolute right-4 top-1/2 transform -translate-y-1/2 pointer-events-none text-gray-400"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></div>
            </div>
            <div class="relative group md:col-span-1">
              <select id="chapter-select" disabled class="modern-input w-full px-4 py-3.5 rounded-xl appearance-none text-gray-700 font-medium cursor-pointer disabled:bg-gray-50 disabled:cursor-not-allowed"><option value=""> </option></select>
              <label class="form-label-float absolute left-4 top-3.5 text-gray-400 text-sm">ржЕржзрзНржпрж╛рзЯ / ржЯржкрж┐ржХ</label>
              <div class="absolute right-4 top-1/2 transform -translate-y-1/2 pointer-events-none text-gray-400"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></div>
            </div>
            <div class="relative group">
              <select id="type" class="modern-input w-full px-4 py-3.5 rounded-xl appearance-none text-gray-700 font-medium cursor-pointer">
                <option value="Mixed">Mixed (рж╕ржм ржзрж░ржирзЗрж░)</option><option value="MCQ">MCQ</option><option value="Short">Short (рж╕ржВржХрзНрж╖рж┐ржкрзНржд)</option><option value="Long">Long (рж░ржЪржирж╛ржорзВрж▓ржХ)</option>
              </select>
              <label class="form-label-float absolute left-4 top-3.5 text-gray-400 text-sm">ржкрзНрж░рж╢рзНржирзЗрж░ ржзрж░ржи</label>
              <div class="absolute right-4 top-1/2 transform -translate-y-1/2 pointer-events-none text-gray-400"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></div>
            </div>
            <div class="relative group">
              <input type="number" id="question-count" value="10" min="5" max="50" placeholder=" " class="modern-input w-full px-4 py-3.5 rounded-xl text-gray-700 font-medium">
              <label class="form-label-float absolute left-4 top-3.5 text-gray-400 text-sm">ржкрзНрж░рж╢рзНржирзЗрж░ рж╕ржВржЦрзНржпрж╛ (рзл-рзлрзж)</label>
            </div>
          </div>
          <button id="generate-btn" disabled class="mt-8 w-full bg-gradient-to-r from-primary-600 to-primary-700 hover:from-primary-700 hover:to-primary-800 text-white font-bold py-4 px-6 rounded-xl shadow-lg shadow-primary-500/30 transform hover:-translate-y-0.5 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed disabled:shadow-none flex items-center justify-center gap-3">
            <span id="btn-text">ржкрзНрж░рж╢рзНржи ржЬрзЗржирж╛рж░рзЗржЯ ржХрж░рзБржи</span>
            <div id="loader" class="hidden"><div class="spinner"></div></div>
            <svg id="btn-icon" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg>
          </button>
        </div>
        <div id="result-container" class="space-y-5 pb-10">
          <div id="message-area" class="flex flex-col items-center justify-center py-16 text-center text-gray-400">
            <div class="w-24 h-24 bg-white rounded-full flex items-center justify-center mb-4 shadow-sm border border-primary-50">
              <svg class="w-10 h-10 text-primary-200" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"></path></svg>
            </div>
            <p class="text-lg font-medium">рж╢рзБрж░рзБ ржХрж░рждрзЗ ржЙржкрж░рзЗрж░ ржлрж░рзНржоржЯрж┐ ржкрзВрж░ржг ржХрж░рзБржи</p>
          </div>
        </div>
      </section>

      <section id="tab-content-tracker" class="hidden animate-fade-in space-y-6" aria-labelledby="tab-btn-tracker">
        <div class="bg-gradient-to-r from-primary-600 to-primary-700 rounded-3xl p-6 md:p-8 shadow-lg text-white">
          <div class="flex flex-col md:flex-row justify-between items-center gap-6">
            <div>
              <h2 class="text-2xl font-bold mb-2">рж╕рж┐рж▓рзЗржмрж╛рж╕ ржЕржЧрзНрж░ржЧрждрж┐ ржбрзНржпрж╛рж╢ржмрзЛрж░рзНржб</h2>
              <p class="text-primary-100 text-sm">ржЪрзНржпрж╛ржкрзНржЯрж╛рж░ рж╢рзЗрж╖ ржХрж░рзЗ ржЪрзЗржХрж▓рж┐рж╕рзНржЯ ржЖржкржбрзЗржЯ ржХрж░рзБржи</p>
            </div>
            <div class="flex-1 w-full md:max-w-md bg-white/10 p-4 rounded-xl border border-white/20 backdrop-blur-sm">
              <div class="flex justify-between items-end mb-2">
                <span class="text-sm font-medium text-primary-50" id="tracker-summary-text">рж▓рзЛржбрж┐ржВ...</span>
                <span class="text-2xl font-bold" id="tracker-percent">0%</span>
              </div>
              <div class="w-full bg-black/20 rounded-full h-3">
                <div id="tracker-progress-bar" class="bg-accent-500 h-3 rounded-full transition-all duration-700 ease-out" style="width: 0%"></div>
              </div>
            </div>
          </div>
        </div>

        <div class="flex justify-end">
          <div class="relative group w-full md:w-64">
            <select id="tracker-year-filter" class="modern-input w-full px-4 py-2.5 rounded-xl appearance-none text-gray-700 font-medium cursor-pointer">
              </select>
            <div class="absolute right-4 top-1/2 transform -translate-y-1/2 pointer-events-none text-gray-400"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></div>
          </div>
        </div>

        <div id="tracker-list-container" class="space-y-4 pb-10">
          </div>
      </section>

      <section id="tab-content-collection" class="hidden animate-fade-in" aria-labelledby="tab-btn-collection">
        <div class="bg-white rounded-3xl p-6 md:p-8 shadow-lg shadow-primary-500/5 border border-white min-h-[500px]">
          <div class="flex flex-wrap items-center justify-between mb-8 gap-4">
            <h2 class="text-xl font-bold text-gray-800 flex items-center gap-2">
              <span class="p-1.5 bg-yellow-100 rounded-lg text-yellow-600"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z"></path></svg></span>
              рж╕ржВрж░ржХрзНрж╖рж┐ржд ржкрзНрж░рж╢рзНржи
            </h2>
            <div class="flex items-center gap-3">
              <button id="download-pdf-btn" class="text-xs font-semibold bg-primary-50 text-primary-700 px-4 py-2.5 rounded-xl hover:bg-primary-100 transition shadow-sm border border-primary-100 flex items-center gap-2">
                 <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path></svg>
                 PDF Download
              </button>
              
              <button id="export-csv-btn" class="text-xs font-semibold bg-gray-50 text-gray-700 px-4 py-2.5 rounded-xl hover:bg-gray-100 transition shadow-sm border border-gray-100">Export CSV</button>
              <button id="clear-all-btn" class="text-xs font-semibold bg-red-50 text-red-700 px-4 py-2.5 rounded-xl hover:bg-red-100 transition shadow-sm border border-red-100">Clear All</button>
            </div>
          </div>
          <div id="collection-container" class="space-y-5"></div>
        </div>
      </section>
    </div>
  </main>

  <footer class="mt-auto py-8 text-center text-gray-400 text-sm font-medium border-t border-primary-100 bg-white/50 backdrop-blur-sm pb-32 md:pb-8">
    <p>&copy; Shahadot 2025. All rights reserved.</p>
  </footer>

  <!-- FAB updated position: Right Side and slightly higher -->
  <button id="chat-fab" class="fixed bottom-6 right-6 z-40 w-14 h-14 bg-gradient-to-r from-primary-600 to-primary-700 text-white rounded-full shadow-xl hover:shadow-2xl hover:scale-110 transition-all duration-300 flex items-center justify-center group border-2 border-white">
    <svg class="w-7 h-7 group-hover:animate-bounce-slow" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path></svg>
    <span class="absolute -top-1 -right-1 w-4 h-4 bg-green-500 rounded-full border-2 border-white"></span>
  </button>

  <!-- Updated Chat Widget Structure for Right Side -->
  <div id="chat-widget" class="chat-closed fixed z-50 flex flex-col transition-all duration-300 origin-bottom-right bg-white shadow-2xl 
       md:bottom-24 md:right-6 md:w-96 md:h-[500px] md:rounded-2xl md:border md:border-primary-100
       bottom-0 right-0 w-full h-[100dvh] rounded-none border-none">
       
    <div class="p-4 bg-gradient-to-r from-primary-600 to-primary-700 text-white md:rounded-t-2xl flex justify-between items-center shadow-sm flex-none">
      <div class="flex items-center gap-3">
         <div class="w-2.5 h-2.5 bg-green-400 rounded-full animate-pulse shadow-[0_0_8px_rgba(74,222,128,0.6)]"></div>
         <div><h3 class="font-bold text-sm md:text-base">AI рж╕рзНржЯрж╛ржбрж┐ ржЕрзНржпрж╛рж╕рж┐рж╕рзНржЯрзНржпрж╛ржирзНржЯ</h3><p class="text-[10px] md:text-xs opacity-90 text-primary-100">рж╕ржм рж╕ржорзЯ ржЖржкржирж╛рж░ рж╕рж╛ржерзЗ</p></div>
      </div>
      <button id="close-chat-btn" class="hover:bg-white/20 p-1.5 rounded-lg transition-colors"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button>
    </div>
    
    <div id="chat-body" class="flex-1 overflow-y-auto p-4 space-y-4 bg-slate-50 scroll-smooth">
      <div class="flex gap-3 items-start">
         <div class="w-8 h-8 rounded-full bg-primary-100 border border-primary-200 flex items-center justify-center text-primary-600 text-xs font-bold flex-shrink-0">AI</div>
         <div class="bg-white p-3.5 rounded-2xl rounded-tl-none shadow-sm text-sm text-gray-700 border border-gray-100 leading-relaxed">рж╣рзНржпрж╛рж▓рзЛ! ЁЯСЛ ржЖржорж┐ ржЖржкржирж╛рж░ ржкрж╛рж░рзНрж╕рзЛржирж╛рж▓ рж╕рзНржЯрж╛ржбрж┐ ржЕрзНржпрж╛рж╕рж┐рж╕рзНржЯрзНржпрж╛ржирзНржЯред рж╕ржорж╛ржЬржХрж░рзНржо ржмрж┐рж╖рзЯржХ ржпрзЗржХрзЛржирзЛ ржкрзНрж░рж╢рзНржи ржЖржорж╛ржХрзЗ ржХрж░рждрзЗ ржкрж╛рж░рзЗржиред</div>
      </div>
    </div>
    
    <div class="p-3 border-t border-gray-100 bg-white md:rounded-b-2xl flex-none pb-safe">
      <div class="relative flex items-center gap-2">
        <input type="text" id="chat-input" placeholder="ржЖржкржирж╛рж░ ржкрзНрж░рж╢рзНржи рж▓рж┐ржЦрзБржи..." class="flex-1 bg-gray-50 border border-gray-200 rounded-xl pl-4 pr-3 py-3 text-sm focus:outline-none focus:border-primary-400 focus:ring-2 focus:ring-primary-100 transition-all">
        <button id="send-msg-btn" class="bg-primary-600 hover:bg-primary-700 text-white p-3 rounded-xl transition-all shadow-md hover:shadow-lg transform active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"></path></svg></button>
      </div>
    </div>
  </div>

  <div id="toast-container"></div>

  <script>
    // --- API Configuration ---
    const apiKey = ""; 
    const geminiModel = 'gemini-2.5-flash-preview-09-2025';
    const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/${geminiModel}:generateContent?key=${apiKey}`;

    // --- State Keys ---
    const LS_KEY_QUESTION_GEN= 'nuSmartApp_questionGenResult_v1';
    const LS_KEY_YEAR = 'nuSmartApp_form_year_v1';
    const LS_KEY_SUBJECT = 'nuSmartApp_form_subject_v1';
    const LS_KEY_CHAPTER = 'nuSmartApp_form_chapter_v1';
    const LS_KEY_SAVED = 'nuSmartApp_savedQuestions_v1';
    const LS_KEY_SYLLABUS = 'nuSmartApp_syllabus_v1';

    // --- Data ---
    const subjectData = {
      "1st Year":[{"name":"рж╕ржорж╛ржЬржХрж░рзНржо ржкрж░рж┐ржЪрж┐рждрж┐ (Introduction to Social Work)","chapters":["рж╕ржорж╛ржЬржХрж░рзНржорзЗрж░ рж╕ржВржЬрзНржЮрж╛ ржУ ржзрж╛рж░ржгрж╛","рж╕ржорж╛ржЬржХрж░рзНржо ржУ рж╕ржорж╛ржЬржХрж▓рзНржпрж╛ржгрзЗрж░ ржкрж╛рж░рзНржержХрзНржп","рж╕ржорж╛ржЬрж╕рзЗржмрж╛ (Social Service) ржУ рж╕ржорж╛ржЬржмрж┐ржХрж╛рж╢ (Social Development)","рж╕рж╛ржорж╛ржЬрж┐ржХ рж╕ржорж╕рзНржпрж╛ (Social Problems)","рж╕рж╛ржорж╛ржЬрж┐ржХ ржкрж░рж┐ржмрж░рзНрждржи (Social Change)","рж╕рж╛ржорж╛ржЬрж┐ржХ ржирж┐рзЯржирзНрждрзНрж░ржи (Social Control)","рж╕рж╛ржорж╛ржЬрж┐ржХ рж╕ржВрж╕рзНржХрж╛рж░ (Social Reform)","рж╕ржорж╛ржЬржХрж░рзНржорзЗрж░ тАШ ржЙржжрзНржнржм ржУ ржмрж┐ржХрж╛рж╢ тАЩ (Historical Development)","рж╕ржорж╛ржЬржХрж░рзНржорзЗрж░ ржЙржжрзНржжрзЗрж╢рзНржп ржУ ржХрж╛рж░рзНржпрж╛ржмрж▓рзА","рж╕ржорж╛ржЬржХрж░рзНржорзЗрж░ ржирзИрждрж┐ржХ / ржирзИрждрж┐ржХржмрж┐ржзрж┐ (Ethics of Social Work)","ржкрзЗрж╢рж╛ржЧржд рж╕ржорж╛ржЬржХрж░рзНржо (Professional Social Work)","рж╕ржорж╛ржЬржХрж░рзНржо ржУ ржорж╛ржиржмрж┐ржХ ржорзВрж▓рзНржпржмрзЛржз","рж╕ржорж╛ржЬржХрж░рзНржо ржУ ржЕржирзНржпрж╛ржирзНржп рж╢рж╛рж╕рзНрждрзНрж░рзЗрж░ рж╕ржорзНржкрж░рзНржХ ( рж╕рж╛ржорж╛ржЬрж┐ржХ ржмрж┐ржЬрзНржЮрж╛ржи , ржоржирзЛржмрж┐ржЬрзНржЮрж╛ржи ржЗрждрзНржпрж╛ржжрж┐ )","ржмрж╛ржВрж▓рж╛ржжрзЗрж╢рзЗ рж╕ржорж╛ржЬржХрж░рзНржорзЗрж░ ржЕржЧрзНрж░ржЧрждрж┐ ржУ рж╕ржорж╕рж╛ржорзЯрж┐ржХ ржЪрзНржпрж╛рж▓рзЗржЮрзНржЬ","ржЖржирзНрждрж░рзНржЬрж╛рждрж┐ржХ рж╕ржорж╛ржЬржХрж░рзНржо ржкрзНрж░ржмржгрждрж╛ ржУ ржЙржжрж╛рж╣рж░ржг"]},{"name":"ржмрж╛ржВрж▓рж╛ржжрзЗрж╢ ржЕржзрзНржпрзЯржи : ржЗрждрж┐рж╣рж╛рж╕ , рж╕ржВрж╕рзНржХрзГрждрж┐ ржУ ржРрждрж┐рж╣рзНржп","chapters":["ржнрзВржЧрзЛрж▓ ржУ ржкрзНрж░рж╛ржХржЧрзЛрж▓","ржкрзНрж░рж╛ржЪрзАржи ржмрж╛ржВрж▓рж╛ / ржкрзНрж░рж╛ржЧрзИрждрж┐рж╣рж╛рж╕рж┐ржХ ржПржмржВ ржкрзНрж░рж╛ржЪрзАржи рж╕ржнрзНржпрждрж╛","ржоржзрзНржпржпрзБржЧрзАржпрж╝ ржмрж╛ржВрж▓рж╛","ржмрж╛ржВрж▓рж╛ ржорзБрж╕рж▓рж┐ржо рж╢рж╛рж╕ржи and ржорзБрж╕рж▓рж┐ржо ржмрж╛ржВрж▓рж╛","ржмрж╛ржЩрж╛рж▓рж┐ рж╕ржВрж╕рзНржХрзГрждрж┐ ржУ ржнрж╛рж╖рж╛рж░ ржмрж┐ржХрж╛рж╢","ржмрж╛ржВрж▓рж╛ рж╕рж╛рж╣рж┐рждрзНржпрзЗрж░ ржЗрждрж┐рж╣рж╛рж╕ ржУ ржЧржаржи","ржзрж░рзНржо ржУ ржЖржзрзНржпрж╛рждрзНржорж┐ржХрждрж╛ : ржЗрж╕рж▓рж╛ржо , рж╣рж┐ржирзНржжрзБ , ржмрзМржжрзНржз , ржЬрзИржи ржЗрждрзНржпрж╛ржжрж┐","ржЖрж░ржм , ржлрж╛рж░рж╕рж┐ ржУ ржЙржкржирж┐ржмрзЗрж╢рж┐ржХ ржкрзНрж░ржнрж╛ржм","ржмрзНрж░рж┐ржЯрж┐рж╢ ржнрж╛рж░ржд ржУ ржЙржкржирж┐ржмрзЗрж╢ржмрж╛ржж","ржЖржирзНржжрзЛрж▓ржи ржУ ржмрж╛ржЩрж╛рж▓рзА рж░рзВржкрж╛ржирзНрждрж░ ( рззрзорзлрзн ржорж┐ржЙржЯрж┐ржирж┐ , ржмржЩрзНржЧржнржЩрзНржЧ , ржорзБрж╕рж▓рж┐ржо рж▓рж┐ржЧ тАУ ржЬрж╛рждрзАржпрж╝рждрж╛ржмрж╛ржж )","ржнрж╛рж╖рж╛ ржЖржирзНржжрзЛрж▓ржи ржУ рж╕рж╛ржВрж╕рзНржХрзГрждрж┐ржХ ржЪрзЗрждржирж╛","рззрзпрзкрзн ржкрж░ржмрж░рзНрждрзА ржЕржмрж╕рзНржерж╛ : ржкрзВрж░рзНржм ржЧрзЛржбрж╝рж╛ржкрждрзНрждржи","ржорзБржХрзНрждрж┐ржпрзБржжрзНржз рззрзпрзнрзз : ржХрж╛рж░ржг , ржШржЯржирж╛ , ржкрж░рж┐ржгрждрж┐","рж╕рзНржмрж╛ржзрзАржи ржмрж╛ржВрж▓рж╛ржжрзЗрж╢рзЗрж░ ржЗрждрж┐рж╣рж╛рж╕ ржУ рж░рж╛рж╖рзНржЯрзНрж░ ржЧржаржи","ржЬрж╛рждрзАрзЯ ржкрзНрж░рждрзАржХ , рж╕рзНржорзГрждрж┐рж╕рзМржз ржУ рж╕ржВржЧрзНрж░рж╣рж╢рж╛рж▓рж╛","рж▓рзЛржХрж╕ржнрзНржпрждрж╛ ржУ ┘В┘И┘Е█М ржРрждрж┐рж╣рзНржп","ржирзГрждрждрзНрждрзНржм ржУ ржЖржжрж┐ржмрж╛рж╕рзА рж╕ржВрж╕рзНржХрзГрждрж┐","рж╕рж╛ржВрж╕рзНржХрзГрждрж┐ржХ рж╢рж┐рж▓рзНржкржХрж▓рж╛рж╕ржорзВрж╣ ( рж╕ржВржЧрзАржд , ржирж╛ржЯржХ , ржирзГрждрзНржп , ржЪрж┐рждрзНрж░ржХрж▓рж╛ , рж╣рж╕рзНрждрж╢рж┐рж▓рзНржк )","ржЖржзрзБржирж┐ржХ ржмрж╛ржВрж▓рж╛ржжрзЗрж╢ : ржкрж░рж┐ржмрж░рзНрждржи ржУ ржЪрзНржпрж╛рж▓рзЗржЮрзНржЬ","ржЖржирзНрждрж░рзНржЬрж╛рждрж┐ржХ ржкрзНрж░ржнрж╛ржм ржУ ржмрзИржЪрж┐рждрзНрж░рзНржп"]},{"name":"рж╕ржорж╛ржЬржХрж░рзНржорзЗрж░ ржЗрждрж┐рж╣рж╛рж╕ ржУ ржжрж░рзНрж╢ржи","chapters":["рж╕ржорж╛ржЬржХрж░рзНржорзЗрж░ ржЗрждрж┐рж╣рж╛рж╕ : ржкрзНрж░рж╛рж░ржорзНржнрж┐ржХ ржпрзБржЧ","рж╕ржорж╛ржЬржХрж░рзНржорзЗрж░ ржЖржзрзБржирж┐ржХрзАржХрж░ржг ржПржмржВ ржмрж┐ржХрж╛рж╢","рж╕ржорж╛ржЬржХрж░рзНржорзЗрж░ ржорзВрж▓ ржзрж╛рж░ржгрж╛ ржУ ржжрж░рзНрж╢ржи","рж╕ржорж╛ржЬржХрж░рзНржорзЗрж░ ржирзИрждрж┐ржХ ржУ ржЖржжрж░рзНрж╢ржЧржд ржнрж┐рждрзНрждрж┐","рж╕ржорж╛ржЬржХрж░рзНржорзЗрж░ ржмрж┐ржнрж┐ржирзНржи ржжрж╛рж░рзНрж╢ржирж┐ржХ ржкрзНрж░ржмржгрждрж╛","рж╕ржорж╛ржЬржХрж░рзНржорзЗрж░ ржзрж░рзНржорзАрзЯ ржУ ржорж╛ржиржмрждрж╛ржмрж╛ржжрзА ржжрзГрж╖рзНржЯрж┐ржнржЩрзНржЧрж┐","рж╕ржорж╛ржЬржХрж░рзНржорзЗрж░ ржмрзИржЬрзНржЮрж╛ржирж┐ржХ ржУ ржкрзНрж░рж╛рждрж┐рж╖рзНржарж╛ржирж┐ржХ ржмрж┐ржХрж╛рж╢","ржмрж┐рж╢рзНржмржмрзНржпрж╛ржкрзА рж╕ржорж╛ржЬржХрж░рзНржорзЗрж░ ржЗрждрж┐рж╣рж╛рж╕ ржУ ржкрзНрж░ржнрж╛ржм","ржмрж╛ржВрж▓рж╛ржжрзЗрж╢рзЗ рж╕ржорж╛ржЬржХрж░рзНржорзЗрж░ ржЗрждрж┐рж╣рж╛рж╕ ржУ ржЪрж▓ржорж╛ржи ржЪрзНржпрж╛рж▓рзЗржЮрзНржЬ","рж╕ржорж╛ржЬржХрж░рзНржорзЗрж░ ржнржмрж┐рж╖рзНржпрзО ржзрж╛рж░рж╛ ржУ ржЪрзНржпрж╛рж▓рзЗржЮрзНржЬ"]},{"name":"ржорж╛ржиржм ржоржирзЛржмрж┐ржЬрзНржЮрж╛ржи ржУ рж╕ржорж╛ржЬржХрж░рзНржо","chapters":["ржоржирзЛржмрж┐ржЬрзНржЮрж╛ржирзЗрж░ рж╕ржВржЬрзНржЮрж╛ , ржмрж┐рж╖рзЯ ржУ ржкрзНрж░ржХрж╛рж░ржнрзЗржж","ржорж╛ржиржм ржЖржЪрж░ржг ржУ ржмрж┐ржХрж╛рж╢","ржоржирзЛржмрж┐ржЬрзНржЮрж╛ржирзЗрж░ ржкрзНрж░ржзрж╛ржи ржкрзНрж░ржмрж╛рж╣рж╕ржорзВрж╣ (Behaviorism, Psychoanalysis, Humanistic Psychology ржЗрждрзНржпрж╛ржжрж┐ )","ржЖржмрзЗржЧ , ржмрзБржжрзНржзрж┐ржорждрзНрждрж╛ ржУ ржмрзНржпржХрзНрждрж┐рждрзНржмрзЗрж░ ржкрж░рж┐ржЪрж┐рждрж┐","рж╕рзНржорзГрждрж┐ ржУ рж╢рзЗржЦрж╛рж░ ржкрзНрж░ржХрзНрж░рж┐рзЯрж╛","ржоржирзЛржмрзИржЬрзНржЮрж╛ржирж┐ржХ ржкрж░рзАржХрзНрж╖ржг ржУ ржорзВрж▓рзНржпрж╛рзЯржи","ржорж╛ржирж╕рж┐ржХ рж░рзЛржЧ ржУ ржмрж┐ржХрзГрждрж┐","рж╕ржорж╛ржЬржХрж░рзНржорзЗ ржоржирзЛржмрж┐ржЬрзНржЮрж╛ржирзЗрж░ ржкрзНрж░рзЯрзЛржЧ","ржорж╛ржирж╕рж┐ржХ рж╕рзНржмрж╛рж╕рзНржерзНржп ржУ рж╕ржорж╛ржЬржХрж░рзНржо"," рж╢рж┐рж╢рзБ , ржХрж┐рж╢рзЛрж░ ржУ ржкрзНрж░ржмрзАржгржжрзЗрж░ ржоржирзЛржмрж┐ржЬрзНржЮрж╛ржи","ржоржирзЛржмрж┐ржЬрзНржЮрж╛ржирзЗрж░ рж╕рж╛рж╣рж╛ржпрзНржпрзЗ ржХрзНрж▓рж╛рзЯрзЗржирзНржЯрзЗрж░ рж╕рж╣рж╛рзЯрждрж╛ ржУ рж╕ржорж╕рзНржпрж╛ рж╕ржорж╛ржзрж╛ржи","ржоржирзЛржмрзИржЬрзНржЮрж╛ржирж┐ржХ ржерзЗрж░рж╛ржкрж┐ ржУ рж╕рж╛ржорж╛ржЬрж┐ржХ ржкрзБржирж░рзНржмрж╛рж╕ржи"]},{"name":"ржЕрж░рзНржержирзАрждрж┐ ржУ ржЙржирзНржирзЯржи","chapters":["ржЕрж░рзНржержирзАрждрж┐рж░ ржорзМрж▓рж┐ржХ ржзрж╛рж░ржгрж╛ ржУ рж╢рж╛ржЦрж╛рж╕ржорзВрж╣","рж╕ржорзНржкржжрзЗрж░ рж╢рзНрж░рзЗржгрзАржмрж┐ржнрж╛ржЧ ржУ ржЕрж░рзНржержирзИрждрж┐ржХ рж╕ржорж╕рзНржпрж╛","ржЪрж╛рж╣рж┐ржжрж╛ ржУ ржпрзЛржЧрж╛ржи","ржЙрзОржкрж╛ржжржи , ржЙржкржпрзЛржЧрж┐рждрж╛ ржУ ржЦрж░ржЪ","ржмрж╛ржЬрж╛рж░ ржУ ржорзВрж▓рзНржп ржирж┐рж░рзНржзрж╛рж░ржг","ржорж╛ржХрзНрж░рзЛржЗржХрзЛржиржорж┐ржХрзНрж╕ : ржорзЛржЯ ржЪрж╛рж╣рж┐ржжрж╛ ржУ ржорзЛржЯ ржпрзЛржЧрж╛ржи","ржЕрж░рзНржержирзИрждрж┐ржХ ржмрзГржжрзНржзрж┐ ржУ ржЙржирзНржирзЯржирзЗрж░ ржзрж╛рж░ржгрж╛","ржЙржирзНржирзЯржи ржЕрж░рзНржержирзАрждрж┐рж░ ржмрзИрж╢рж┐рж╖рзНржЯрзНржп ржУ рж▓ржХрзНрж╖ржг","ржжрж╛рж░рж┐ржжрзНрж░рзНржп , ржмрзЗржХрж╛рж░рждрзНржм ржУ ржЕрж╕ржорждрж╛","ржЙржирзНржирзЯржи ржирзАрждрж┐ржорж╛рж▓рж╛ ржУ ржкрж░рж┐ржХрж▓рзНржкржирж╛","ржмрж╛ржВрж▓рж╛ржжрзЗрж╢рзЗ ржЕрж░рзНржержирзИрждрж┐ржХ ржЙржирзНржирзЯржи : рж╕ржорж╕рзНржпрж╛ ржУ рж╕ржорзНржнрж╛ржмржирж╛","ржмрзИрж╢рзНржмрж┐ржХ ржЕрж░рзНржержирзАрждрж┐ ржУ ржЙржирзНржирзЯржи рж╕рж╣ржпрзЛржЧрж┐рждрж╛","ржкрж░рж┐ржмрзЗрж╢ ржУ ржЯрзЗржХрж╕ржЗ ржЙржирзНржирзЯржи","ржЕрж░рзНржержирзИрждрж┐ржХ рж╕ржВрж╕рзНржХрж╛рж░ ржУ ржЖржзрзБржирж┐ржХрж╛рзЯржи","ржЕрж░рзНржержирзАрждрж┐ ржУ рж╕ржорж╛ржЬржХрж░рзНржорзЗрж░ рж╕ржВржпрзЛржЧ"]},{"name":"ржмрж╛ржВрж▓рж╛ржжрзЗрж╢ рж╕рзНржмрж╛ржзрзАржирждрж╛ ржпрзБржжрзНржзрзЗрж░ ржЗрждрж┐рж╣рж╛рж╕","chapters":["ржкрзВрж░рзНржм ржмрж╛ржВрж▓рж╛рж░ рж░рж╛ржЬржирзИрждрж┐ржХ ржУ рж╕рж╛ржорж╛ржЬрж┐ржХ ржкрзНрж░рзЗржХрзНрж╖рж╛ржкржЯ ( рззрзпрзкрзн - рззрзпрзнрзж )","рззрзпрзкрзн ржерзЗржХрзЗ рззрзпрзнрзз ржкрж░рзНржпржирзНржд ржкрж╛ржХрж┐рж╕рзНрждрж╛ржи рж╢рж╛рж╕ржи","ржнрж╛рж╖рж╛ ржЖржирзНржжрзЛрж▓ржи ( рззрзпрзлрзи ) ржУ ржПрж░ ржкрзНрж░ржнрж╛ржм","рзм ржжржлрж╛ ржЖржирзНржжрзЛрж▓ржи ( рззрзпрзмрзм )","рззрзпрзнрзж рж╕рж╛рж▓рзЗрж░ рж╕рж╛ржзрж╛рж░ржг ржирж┐рж░рзНржмрж╛ржЪржи ржУ ржПрж░ ржлрж▓рж╛ржлрж▓","ржмрж╛ржВрж▓рж╛ржжрзЗрж╢рзЗрж░ ржорзБржХрзНрждрж┐ржпрзБржжрзНржзрзЗрж░ рж╕рзВржЪржирж╛ ( рзирзм ржорж╛рж░рзНржЪ рззрзпрзнрзз )","ржорзБржХрзНрждрж┐ржпрзБржжрзНржзрзЗрж░ ржкрзНрж░ржзрж╛ржи ржШржЯржирж╛ ржУ ржпрзБржжрзНржзржХрзМрж╢рж▓","рж╕рзНржмрж╛ржзрзАржирждрж╛ ржпрзБржжрзНржзрзЗрж░ ржирзЗрждрж╛ ржУ рж╕ржВржЧржаржирж╕ржорзВрж╣","ржорзБржХрзНрждрж┐ржпрзБржжрзНржзрзЗрж░ ржЖржирзНрждрж░рзНржЬрж╛рждрж┐ржХ ржкрзНрж░рзЗржХрзНрж╖рж╛ржкржЯ ржУ рж╕рж╛рж╣рж╛ржпрзНржп","рззрзм ржбрж┐рж╕рзЗржорзНржмрж░ рззрзпрзнрзз : ржмрж┐ржЬрзЯ ржжрж┐ржмрж╕ ржУ ржорзБржХрзНрждрж┐ржпрзБржжрзНржзрзЗрж░ рж╕ржорж╛ржкрзНрждрж┐","ржорзБржХрзНрждрж┐ржпрзБржжрзНржзрзЗрж░ ржкрж░ржмрж░рзНрждрзА ржмрж╛ржВрж▓рж╛ржжрзЗрж╢ : рж░рж╛ржЬржирзАрждрж┐ ржУ рж╕ржорж╛ржЬ ржкрж░рж┐ржмрж░рзНрждржи","ржорзБржХрзНрждрж┐ржпрзБржжрзНржзрзЗрж░ рж╕рзНржорзГрждрж┐ ржУ ржЬрж╛рждрзАрзЯ ржРрждрж┐рж╣рзНржп рж╕ржВрж░ржХрзНрж╖ржг"]}],
      "2nd Year":[{"name":"ржорж╛ржиржм ржЬрзАржмржмрж┐ржжрзНржпрж╛ : ржмрзГржжрзНржзрж┐ ржУ ржмрж┐ржХрж╛рж╢","chapters":["ржорж╛ржиржм ржЬрзАржмржмрж┐ржжрзНржпрж╛рж░ ржкрж░рж┐ржЪрж┐рждрж┐ ржУ ржЧрзБрж░рзБрждрзНржм","ржорж╛ржиржм ржжрзЗрж╣рзЗрж░ ржЧржаржи : ржХрзЛрж╖ , ржЯрж┐рж╕рзНржпрзБ ржУ ржЕржЩрзНржЧржкрзНрж░рждрзНржпржЩрзНржЧ","ржорж╛ржиржм ржжрзЗрж╣рзЗрж░ ржкрзНрж░ржзрж╛ржи рж╕рж┐рж╕рзНржЯрзЗржорж╕ржорзВрж╣ ( ржкрзЗрж╢рзА , ржХржЩрзНржХрж╛рж▓ , рж╕рзНржирж╛ржпрж╝рзБ , рж░ржХрзНржд рж╕ржЮрзНржЪрж╛рж▓ржи ржЗрждрзНржпрж╛ржжрж┐ )","ржорж╛ржиржм ржмрзГржжрзНржзрж┐ ржУ ржмрж┐ржХрж╛рж╢рзЗрж░ ржзрж╛ржкрж╕ржорзВрж╣ ( рж╢рж┐рж╢рзБ , ржХрзИрж╢рзЛрж░ , ржкрзНрж░рж╛ржкрзНрждржмржпрж╝рж╕рзНржХ , ржмрзГржжрзНржз )","ржорж╛ржиржм ржЬрзАржмржирзЗ ржкрзБрж╖рзНржЯрж┐ ржУ ржЦрж╛ржжрзНржпрзЗрж░ ржнрзВржорж┐ржХрж╛","ржорж╛ржиржм рж╢рж╛рж░рзАрж░ржмрзГрждрзНрждрзАржпрж╝ ржкрж░рж┐ржмрж░рзНрждржирж╕ржорзВрж╣ ( рж╣рж░ржорзЛржи , ржкрзНрж░ржЬржиржи ржкрзНрж░ржХрзНрж░рж┐ржпрж╝рж╛ )","рж░рзЛржЧ ржУ рж░рзЛржЧ ржкрзНрж░рждрж┐рж░рзЛржз ржХрзНрж╖ржорждрж╛","ржкрж░рж┐ржмрзЗрж╢ ржУ рж╕рзНржмрж╛рж╕рзНржерзНржп : ржкрзНрж░ржнрж╛ржм ржУ рж╕ржВрж░ржХрзНрж╖ржг","ржорж╛ржиржм ржмрж┐ржХрж╛рж╢рзЗ рж╕рж╛ржорж╛ржЬрж┐ржХ ржУ ржорж╛ржирж╕рж┐ржХ ржкрзНрж░ржнрж╛ржм","рж╕рзНржмрж╛рж╕рзНржерзНржп рж╕ржЪрзЗрждржирждрж╛ ржУ рж╕рзНржмрж╛рж╕рзНржерзНржпржХрж░ ржЬрзАржмржиржпрж╛ржкржи","рж╢рж┐рж╢рзБ ржУ ржХрж┐рж╢рзЛрж░рзЗрж░ ржмрж┐ржХрж╛рж╢рзЗрж░ ржмрзИржЬрзНржЮрж╛ржирж┐ржХ ржжрж┐ржХ","ржмрзГржжрзНржзрж╛ржмрж╕рзНржерж╛рж░ рж╢рж╛рж░рзАрж░рж┐ржХ ржУ ржорж╛ржирж╕рж┐ржХ ржкрж░рж┐ржмрж░рзНрждржи"]},{"name":"рж╕рж╛ржорж╛ржЬрж┐ржХ ржирзАрждрж┐ ржУ ржкрж░рж┐ржХрж▓рзНржкржирж╛","chapters":["рж╕рж╛ржорж╛ржЬрж┐ржХ ржирзАрждрж┐рж░ ржзрж╛рж░ржгрж╛ , ржкрзНрж░рзЯрзЛржЬржирзАрзЯрждрж╛ ржУ ржЙржжрзНржжрзЗрж╢рзНржп","рж╕рж╛ржорж╛ржЬрж┐ржХ ржирзАрждрж┐рж░ ржкрзНрж░ржХрж╛рж░ржнрзЗржж ржУ ржмрзИрж╢рж┐рж╖рзНржЯрзНржп","рж╕рж╛ржорж╛ржЬрж┐ржХ ржирзАрждрж┐рж░ ржкрж░рж┐ржХрж▓рзНржкржирж╛ ржУ ржкрзНрж░ржгрзЯржи ржкрзНрж░ржХрзНрж░рж┐рзЯрж╛","рж╕рж╛ржорж╛ржЬрж┐ржХ ржирзАрждрж┐рж░ ржорзВрж▓рзНржпрж╛рзЯржи ржУ ржмрж╛рж╕рзНрждржмрж╛рзЯржи","рж╕рж╛ржорж╛ржЬрж┐ржХ ржирзАрждрж┐рж░ ржЗрждрж┐рж╣рж╛рж╕ ржУ ржЙржирзНржирзЯржи","ржмрж┐ржнрж┐ржирзНржи ржжрзЗрж╢рзЗ рж╕рж╛ржорж╛ржЬрж┐ржХ ржирзАрждрж┐рж░ ржЙржжрж╛рж╣рж░ржг","ржмрж╛ржВрж▓рж╛ржжрзЗрж╢рзЗрж░ рж╕рж╛ржорж╛ржЬрж┐ржХ ржирзАрждрж┐ ржУ ржкрж░рж┐ржХрж▓рзНржкржирж╛","ржжрж╛рж░рж┐ржжрзНрж░рзНржп ржмрж┐ржорзЛржЪржи ржирзАрждрж┐ ржУ ржХрж░рзНржорж╕рзВржЪрж┐","рж╢рж┐ржХрзНрж╖рж╛ , рж╕рзНржмрж╛рж╕рзНржерзНржп ржУ ржЬржирж╕ржВржЦрзНржпрж╛ ржирзАрждрж┐","ржХрж░рзНржорж╕ржВрж╕рзНржерж╛ржи ржУ рж╢рзНрж░ржо ржирзАрждрж┐","ржирж╛рж░рзА ржУ рж╢рж┐рж╢рзБржмрж┐рж╖рзЯржХ рж╕рж╛ржорж╛ржЬрж┐ржХ ржирзАрждрж┐","ржжрзБрж░рзНржпрзЛржЧ ржмрзНржпржмрж╕рзНржерж╛ржкржирж╛ ржУ рж╕рж╛ржорж╛ржЬрж┐ржХ рж╕рзБрж░ржХрзНрж╖рж╛ ржирзАрждрж┐","ржЖржирзНрждрж░рзНржЬрж╛рждрж┐ржХ рж╕рж╛ржорж╛ржЬрж┐ржХ ржирзАрждрж┐ ржУ ржорж╛ржиржмрж╛ржзрж┐ржХрж╛рж░","рж╕рж╛ржорж╛ржЬрж┐ржХ ржирзАрждрж┐рж░ ржЪрзНржпрж╛рж▓рзЗржЮрзНржЬ ржУ ржнржмрж┐рж╖рзНржпржд рж╕ржорзНржнрж╛ржмржирж╛"]},{"name":"рж╕рж╛ржорж╛ржЬрж┐ржХ рж╕ржорж╕рзНржпрж╛ ржмрж┐рж╢рзНрж▓рзЗрж╖ржг","chapters":["рж╕рж╛ржорж╛ржЬрж┐ржХ рж╕ржорж╕рзНржпрж╛рж░ рж╕ржВржЬрзНржЮрж╛ ржУ ржмрзИрж╢рж┐рж╖рзНржЯрзНржп","рж╕рж╛ржорж╛ржЬрж┐ржХ рж╕ржорж╕рзНржпрж╛рж░ ржХрж╛рж░ржг ржУ ржкрзНрж░ржХрж╛рж░ржнрзЗржж","ржжрж╛рж░рж┐ржжрзНрж░рзНржп ржУ ржжрж╛рж░рж┐ржжрзНрж░рзНржп ржмрж┐ржорзЛржЪржи","ржмрзЗржХрж╛рж░рждрзНржм ржУ ржХрж░рзНржорж╕ржВрж╕рзНржерж╛ржи рж╕ржорж╕рзНржпрж╛","ржЕржкрж░рж╛ржз ржУ ржирзГрж╢ржВрж╕рждрж╛","ржЧрзГрж╣рж╣рзАржирждрж╛ ржУ ржмрж╛рж╕рж╕рзНржерж╛ржи рж╕ржорж╕рзНржпрж╛","ржорж╛ржжржХрж╛рж╕ржХрзНрждрж┐ ржУ ржирзЗрж╢рж╛ рж╕ржорж╕рзНржпрж╛","рж▓рж┐ржЩрзНржЧ ржмрзИрж╖ржорзНржп ржУ ржирж╛рж░рзА ржирж┐рж░рзНржпрж╛рждржи","рж╢рж┐рж╢рзБ ржУ ржХрж┐рж╢рзЛрж░ рж╕ржорж╕рзНржпрж╛","ржкрж╛рж░рж┐ржмрж╛рж░рж┐ржХ рж╕ржорж╕рзНржпрж╛ ржУ ржмрж┐ржмрж╛рж╣ ржмрж┐ржЪрзНржЫрзЗржж","рж╕рж╛ржорж╛ржЬрж┐ржХ рж╕ржорж╕рзНржпрж╛ рж╕ржорж╛ржзрж╛ржирзЗ рж╕рж░ржХрж╛рж░рзА ржУ ржмрзЗрж╕рж░ржХрж╛рж░рзА ржЙржжрзНржпрзЛржЧ","рж╕рж╛ржорж╛ржЬрж┐ржХ ржЖржирзНржжрзЛрж▓ржи ржУ ржкрж░рж┐ржмрж░рзНрждржи","рж╕рж╛ржорзНржкрзНрж░ржжрж╛ржпрж╝рж┐ржХрждрж╛ ржУ ржЬрж╛рждрзАржпрж╝рждрж╛ рж╕ржорж╕рзНржпрж╛","ржЖржзрзБржирж┐ржХрж╛ржпрж╝ржи ржУ рж╕рж╛ржорж╛ржЬрж┐ржХ рж╕ржорж╕рзНржпрж╛","рж╕рж╛ржорж╛ржЬрж┐ржХ рж╕ржорж╕рзНржпрж╛рж░ рждрждрзНрждрзНржм ржУ ржмрж┐рж╢рзНрж▓рзЗрж╖ржг ржкржжрзНржзрждрж┐"]},{"name":"ржирзГрждрждрзНрждрзНржм ржкрж░рж┐ржЪрж┐рждрж┐ (Introduction to Anthropology)","chapters":["ржирзГрждрждрзНрждрзНржмрзЗрж░ рж╕ржВржЬрзНржЮрж╛ , ржЙржжрзНржжрзЗрж╢рзНржп ржУ ржЧрзБрж░рзБрждрзНржм","ржирзГрждрждрзНрждрзНржмрзЗрж░ рж╢рж╛ржЦрж╛ ржУ ржмрж┐рж╖рзЯржмрж╕рзНрждрзБ","ржорж╛ржирзБрж╖рзЗрж░ ржмрж┐ржмрж░рзНрждржи ржУ ржирзГрждрждрзНрждрзНржмрзЗрж░ ржЗрждрж┐рж╣рж╛рж╕","рж╕рж╛ржВрж╕рзНржХрзГрждрж┐ржХ ржирзГрждрждрзНрждрзНржм : рж╕ржВрж╕рзНржХрзГрждрж┐ ржУ рж╕ржорж╛ржЬ","ржнрж╛рж╖рж╛ ржУ ржпрзЛржЧрж╛ржпрзЛржЧрзЗрж░ ржнрзВржорж┐ржХрж╛","ржирзГрждрждрзНрждрзНржмрзЗрж░ ржЧржмрзЗрж╖ржгрж╛ ржкржжрзНржзрждрж┐ ржУ рж╕рж░ржЮрзНржЬрж╛ржо","рж╕рж╛ржорж╛ржЬрж┐ржХ ржХрж╛ржарж╛ржорзЛ ржУ рж╕рж╛ржорж╛ржЬрж┐ржХ ржкрзНрж░рждрж┐рж╖рзНржарж╛ржи","ржзрж░рзНржо ржУ ржЖржзрзНржпрж╛рждрзНржорж┐ржХрждрж╛","ржкрж░рж┐ржмрж╛рж░ ржУ ржмржВрж╢ржкрж░ржорзНржкрж░рж╛","ржирзГрждрж╛рждрзНрждрзНржмрж┐ржХ ржмрж┐ржнрж╛ржЬржи ржУ ржЬрж╛рждрж┐","ржЕрж░рзНржержирзАрждрж┐ ржУ ржмрж┐ржирж┐ржоржпрж╝ ржмрзНржпржмрж╕рзНржерж╛","рж░рж╛ржЬржирзИрждрж┐ржХ ржмрзНржпржмрж╕рзНржерж╛ ржУ ржХрзНрж╖ржорждрж╛","ржирзГрждрж╛рждрзНрждрзНржмрж┐ржХ ржкрж░рж┐ржмрж░рзНрждржи ржУ ржЖржзрзБржирж┐ржХрждрж╛","ржмрж╛ржВрж▓рж╛ржжрзЗрж╢рзЗ ржирзГрждрж╛рждрзНрждрзНржмрж┐ржХ ржмрзИржЪрж┐рждрзНрж░рзНржп ржУ ржЖржжрж┐ржмрж╛рж╕рзА ржЬржиржЧрзЛрж╖рзНржарзА"]},{"name":"ржХржорзНржкрж┐ржЙржЯрж╛рж░ ржУ рждржерзНржп ржкрзНрж░ржпрзБржХрзНрждрж┐","chapters":["ржХржорзНржкрж┐ржЙржЯрж╛рж░рзЗрж░ ржкрж░рж┐ржЪрж┐рждрж┐ ржУ ржЗрждрж┐рж╣рж╛рж╕","ржХржорзНржкрж┐ржЙржЯрж╛рж░рзЗрж░ ржзрж░ржи ржУ ржЙржкрж╛ржжрж╛ржи","рж╣рж╛рж░рзНржбржУржпрж╝рзНржпрж╛рж░ ржПржмржВ рж╕ржлржЯржУржпрж╝рзНржпрж╛рж░","ржЕржкрж╛рж░рзЗржЯрж┐ржВ рж╕рж┐рж╕рзНржЯрзЗржорзЗрж░ ржзрж╛рж░ржгрж╛","рждржерзНржп ржУ рждржерзНржп ржкрзНрж░ржпрзБржХрзНрждрж┐рж░ ржнрзВржорж┐ржХрж╛","ржорж╛ржЗржХрзНрж░рзЛрж╕ржлржЯ ржЕржлрж┐рж╕ : ржУржпрж╝рж╛рж░рзНржб , ржПржХрзНрж╕рзЗрж▓ , ржкрж╛ржУржпрж╝рж╛рж░ржкржпрж╝рзЗржирзНржЯрзЗрж░ ржкрж░рж┐ржЪрж┐рждрж┐","ржЗржирзНржЯрж╛рж░ржирзЗржЯ ржУ ржЗржорзЗржЗрж▓ ржмрзНржпржмрж╣рж╛рж░","ржбрзЗржЯрж╛ржмрзЗрж╕ ржУ рждржерзНржп рж╕ржВрж░ржХрзНрж╖ржг","ржХржорзНржкрж┐ржЙржЯрж╛рж░ ржирзЗржЯржУржпрж╝рж╛рж░рзНржХ ржУ ржпрзЛржЧрж╛ржпрзЛржЧ ржмрзНржпржмрж╕рзНржерж╛","рж╕рж╛ржЗржмрж╛рж░ ржирж┐рж░рж╛ржкрждрзНрждрж╛ ржУ рждржерзНржп рж╕рзБрж░ржХрзНрж╖рж╛","рждржерзНржп ржкрзНрж░ржпрзБржХрзНрждрж┐ ржУ рж╕ржорж╛ржЬ","ржЖржзрзБржирж┐ржХ ржкрзНрж░ржпрзБржХрзНрждрж┐рж░ ржмрзНржпржмрж╣рж╛рж░ ржУ ржкрзНрж░ржнрж╛ржм","ржорзЛржмрж╛ржЗрж▓ ржХржорзНржкрж┐ржЙржЯрж┐ржВ ржУ рж╕рзНржорж╛рж░рзНржЯ ржбрж┐ржнрж╛ржЗрж╕","ржХрзНрж▓рж╛ржЙржб ржХржорзНржкрж┐ржЙржЯрж┐ржВ ржУ ржбрж┐ржЬрж┐ржЯрж╛рж▓ ржбрзЗржЯрж╛","рждржерзНржп ржкрзНрж░ржпрзБржХрзНрждрж┐рждрзЗ ржирждрзБржи ржкрзНрж░ржмржгрждрж╛ ржУ ржнржмрж┐рж╖рзНржпрзО ржжрж┐ржХржирж┐рж░рзНржжрзЗрж╢ржирж╛"]},{"name":"рж╕ржорж╛ржЬрждрждрзНрждрзНржм ржкрж░рж┐ржЪрж┐рждрж┐ (Introduction to Sociology)","chapters":["рж╕ржорж╛ржЬрждрждрзНрждрзНржмрзЗрж░ рж╕ржВржЬрзНржЮрж╛ ржУ ржЕрж░рзНрже","рж╕ржорж╛ржЬ ржУ рж╕рж╛ржорж╛ржЬрж┐ржХ ржкрзНрж░рждрж┐рж╖рзНржарж╛ржи","рж╕ржВрж╕рзНржХрзГрждрж┐ ржУ рж╕рж╛ржорж╛ржЬрж┐ржХрзАржХрж░ржг","рж╕рж╛ржорж╛ржЬрж┐ржХ рж╢рзНрж░рзЗржгрж┐ ржУ рж╕рзНрждрж░ржмрж┐ржирзНржпрж╛рж╕","рж╕рж╛ржорж╛ржЬрж┐ржХ ржкрж░рж┐ржмрж░рзНрждржи ржУ ржкрзНрж░ржХрзНрж░рж┐ржпрж╝рж╛","рж╕рж╛ржорж╛ржЬрж┐ржХ ржирж┐ржпрж╝ржирзНрждрзНрж░ржг ржУ ржЖржЗржи","ржкрж╛рж░рж┐ржмрж╛рж░рж┐ржХ ржкрзНрж░рждрж┐рж╖рзНржарж╛ржи","ржзрж░рзНржо ржУ рж╕ржорж╛ржЬ","ржЬржирж╕ржВржЦрзНржпрж╛ ржУ ржиржЧрж░рж╛ржпрж╝ржи","рж╕рж╛ржорж╛ржЬрж┐ржХ рж╕ржорж╕рзНржпрж╛ ржУ рж╕ржорж╛ржзрж╛ржи","рж╕ржорж╛ржЬрждрждрзНрждрзНржмрзЗрж░ ржмрж┐ржнрж┐ржирзНржи рждрждрзНрждрзНржм ( ржХрж╛рж░рзНрж▓ ржорж╛рж░рзНржХрж╕ , ржорзНржпрж╛ржХрзНрж╕ ржнрзЗржмрж╛рж░ , ржЗржорж┐рж▓ ржжрж╛рж░рзНржХрж╣рзЗржЗржо )","ржмрж╛ржВрж▓рж╛ржжрзЗрж╢рзЗрж░ рж╕рж╛ржорж╛ржЬрж┐ржХ ржХрж╛ржарж╛ржорзЛ ржУ ржкрж░рж┐ржмрж░рзНрждржи"]},{"name":"ржмрж╛ржВрж▓рж╛ржжрзЗрж╢рзЗрж░ ржЕрж░рзНржержирзАрждрж┐ (Economy of Bangladesh)","chapters":["ржмрж╛ржВрж▓рж╛ржжрзЗрж╢рзЗрж░ ржнрзВржЧрзЛрж▓ ржУ ржЕрж░рзНржержирзИрждрж┐ржХ ржкрзНрж░рзЗржХрзНрж╖рж╛ржкржЯ","ржХрзГрж╖рж┐ ржУ рж╢рж┐рж▓рзНржк ржЦрж╛ржд","ржЕрж░рзНржержирзИрждрж┐ржХ ржмрзГржжрзНржзрж┐ ржУ ржЙржирзНржиржпрж╝ржи","рж╢рзНрж░ржо ржмрж╛ржЬрж╛рж░ ржУ ржмрзЗржХрж╛рж░рждрзНржм","ржЬрж╛рждрзАржпрж╝ ржмрж╛ржЬрзЗржЯ ржУ ржХрж░ ржмрзНржпржмрж╕рзНржерж╛","ржмрзНржпрж╛ржВржХрж┐ржВ ржУ ржЖрж░рзНржерж┐ржХ ржкрзНрж░рждрж┐рж╖рзНржарж╛ржи","ржмрзИржжрзЗрж╢рж┐ржХ ржмрж╛ржгрж┐ржЬрзНржп ржУ рж░рзЗржорж┐ржЯрзНржпрж╛ржирзНрж╕","ржжрж╛рж░рж┐ржжрзНрж░рзНржп ржУ рж╕рж╛ржорж╛ржЬрж┐ржХ ржирж┐рж░рж╛ржкрждрзНрждрж╛","ржЙржирзНржиржпрж╝ржи ржкрж░рж┐ржХрж▓рзНржкржирж╛ ржУ ржирзАрждрж┐","ржЕржмржХрж╛ржарж╛ржорзЛ ржЙржирзНржиржпрж╝ржи","ржкрж░рж┐ржмрзЗрж╢ ржУ ржЯрзЗржХрж╕ржЗ ржЙржирзНржиржпрж╝ржи","ржмрж░рзНрждржорж╛ржи ржЕрж░рзНржержирзИрждрж┐ржХ рж╕ржорж╕рзНржпрж╛ ржУ рж╕ржорзНржнрж╛ржмржирж╛"]}],
      "3rd Year":[{"name":"рж╕ржорж╛ржЬржХрж░рзНржо ржкржжрзНржзрждрж┐ : ржХрзЗрж╕ржУрзЯрж╛рж░рзНржХ ржУ ржЧрзНрж░рзБржкржУрзЯрж╛рж░рзНржХ (ржкрзЗржкрж╛рж░ ржХрзЛржб : 232101)","chapters":["рж╕ржорж╛ржЬржХрж░рзНржо ржкржжрзНржзрждрж┐рж░ ржкрж░рж┐ржЪрж┐рждрж┐","ржХрзЗрж╕ржУрзЯрж╛рж░рзНржХ : ржзрж╛рж░ржгрж╛ , ржЙржжрзНржжрзЗрж╢рзНржп ржУ ржмрзИрж╢рж┐рж╖рзНржЯрзНржп","ржХрзЗрж╕ржУрзЯрж╛рж░рзНржХ ржкрзНрж░ржХрзНрж░рж┐рзЯрж╛ ржУ ржзрж╛ржкрж╕ржорзВрж╣","ржХрзНрж▓рж╛рзЯрзЗржирзНржЯ ржУ ржХрзНрж▓рж╛рзЯрзЗржирзНржЯ рж╕рж┐рж╕рзНржЯрзЗржо","ржЧрзНрж░рзБржкржУрзЯрж╛рж░рзНржХ : ржзрж╛рж░ржгрж╛ ржУ ржЙржжрзНржжрзЗрж╢рзНржп","ржЧрзНрж░рзБржк ржбрж╛рзЯржирж╛ржорж┐ржХрзНрж╕ ржУ ржЧрзНрж░рзБржк ржерзЗрж░рж╛ржкрж┐","ржЧрзНрж░рзБржк ржкрж░рж┐ржХрж▓рзНржкржирж╛ ржУ ржмрж╛рж╕рзНрждржмрж╛рзЯржи","ржХрзЗрж╕ рж░рзЗржХрж░рзНржбрж┐ржВ ржУ рж░рж┐ржкрзЛрж░рзНржЯрж┐ржВ","рж╕ржорж╛ржЬржХрж░рзНржо ржкржжрзНржзрждрж┐рж░ ржорзВрж▓рзНржпрж╛рзЯржи ржУ рж╕рзАржорж╛ржмржжрзНржзрждрж╛","ржкрзНрж░рзЯрзЛржЧ ржХрзНрж╖рзЗрждрзНрж░ ржУ ржмрж╛рж╕рзНрждржм ржЙржжрж╛рж╣рж░ржг"]},{"name":"рж╕ржорж╛ржЬржХрж░рзНржорзЗ рждрж╛рждрзНрждрзНржмрж┐ржХ ржкрзНрж░рзЯрзЛржЧ (ржкрзЗржкрж╛рж░ ржХрзЛржб : 232103)","chapters":["рж╕ржорж╛ржЬржХрж░рзНржорзЗрж░ рждрж╛рждрзНрждрзНржмрж┐ржХ ржнрж┐рждрзНрждрж┐","ржоржирзЛржмрж┐ржЬрзНржЮрж╛ржи рж╕ржорзНржкрж░рзНржХрж┐ржд рждрждрзНрждрзНржм","рж╕рж╛ржорж╛ржЬрж┐ржХ рждрждрзНрждрзНржм ржУ рж╕ржорж╛ржЬржХрж░рзНржо","ржмрзНржпржХрзНрждрж┐рждрзНржм рждрждрзНрждрзНржм ржУ ржмрж┐ржХрж╛рж╢ рждрждрзНрждрзНржм","рж╕рж╛ржорж╛ржЬрж┐ржХ ржкрж░рж┐ржмрж░рзНрждржи ржУ ржЙржирзНржирзЯржирзЗрж░ рждрждрзНрждрзНржм","рж╕рж╛ржорж╛ржЬрж┐ржХ ржирзНржпрж╛рзЯржмрж┐ржЪрж╛рж░ ржУ ржорж╛ржиржмрж╛ржзрж┐ржХрж╛рж░ рждрждрзНрждрзНржм","рж╕ржорж╛ржЬржХрж░рзНржорзЗ рждрждрзНрждрзНржмрзЗрж░ ржкрзНрж░рзЯрзЛржЧ ржкржжрзНржзрждрж┐","рждрж╛рждрзНрждрзНржмрж┐ржХ ржоржбрзЗрж▓ ржПржмржВ рждрж╛ржжрзЗрж░ ржмрзНржпржмрж╣рж╛рж░","рж╕рж╛ржорж╛ржЬрж┐ржХ рж╕ржорж╕рзНржпрж╛ ржмрж┐рж╢рзНрж▓рзЗрж╖ржг рждрждрзНрждрзНржм","ржмрж╛рж╕рзНрждржм рж╕ржорж╛ржЬржХрж░рзНржорзЗ рждрж╛рждрзНрждрзНржмрж┐ржХ ржкрзНрж░рзЯрзЛржЧрзЗрж░ ржЪрзНржпрж╛рж▓рзЗржЮрзНржЬ"]},{"name":"рж╕рзНржмрзЗржЪрзНржЫрж╛рж╕рзЗржмрзА ржкрзНрж░рждрж┐рж╖рзНржарж╛ржи ржУ ржПржиржЬрж┐ржУ (ржкрзЗржкрж╛рж░ ржХрзЛржб : 232105)","chapters":["рж╕рзНржмрзЗржЪрзНржЫрж╛рж╕рзЗржмрзА рж╕ржВрж╕рзНржерж╛рж░ ржкрж░рж┐ржЪрж┐рждрж┐ ржУ ржкрзНрж░ржХрж╛рж░ржнрзЗржж","ржПржиржЬрж┐ржУ : рж╕ржВржЬрзНржЮрж╛ , ржнрзВржорж┐ржХрж╛ ржУ ржЧрзБрж░рзБрждрзНржм","ржПржиржЬрж┐ржУрж░ ржЗрждрж┐рж╣рж╛рж╕ ржУ ржмрж┐ржХрж╛рж╢","рж╕рзНржмрзЗржЪрзНржЫрж╛рж╕рзЗржмрзА ржХрж╛рж░рзНржпржХрзНрж░ржорзЗрж░ ржкрзНрж░ржХрж╛рж░ржнрзЗржж","ржПржиржЬрж┐ржУрж░ ржХрж╛рж░рзНржпржХрзНрж░ржо ржУ ржХрж╛рж░рзНржпржкржжрзНржзрждрж┐","ржЕрж░рзНржерж╛рзЯржи ржУ рж╕ржорзНржкржж рж╕ржВржЧрзНрж░рж╣","ржПржиржЬрж┐ржУ ржУ рж╕рж░ржХрж╛рж░рзА рж╕рж╣ржпрзЛржЧрж┐рждрж╛","рж╕ржорж╛ржЬржХрж░рзНржорзЗ ржПржиржЬрж┐ржУрж░ ржЕржмржжрж╛ржи","ржЙржирзНржирзЯржи ржХрж╛рж░рзНржпржХрзНрж░ржорзЗ ржПржиржЬрж┐ржУрж░ ржнрзВржорж┐ржХрж╛","ржЪрзНржпрж╛рж▓рзЗржЮрзНржЬ ржУ ржнржмрж┐рж╖рзНржпрзО рж╕ржорзНржнрж╛ржмржирж╛"]},{"name":"ржжрж░рж┐ржжрзНрж░ржжрзЗрж░ рж╕рж╛ржерзЗ ржХрж╛ржЬ : ржирзАрждрж┐ ржУ ржкрзНрж░ржпрж╝рзЛржЧ (ржкрзЗржкрж╛рж░ ржХрзЛржб : 232107)","chapters":["ржжрж░рж┐ржжрзНрж░рждрзНржмрзЗрж░ ржзрж╛рж░ржгрж╛ ржУ ржкрзНрж░ржХрж╛рж░ржнрзЗржж","ржжрж░рж┐ржжрзНрж░ржжрзЗрж░ ржЬрзАржмржирзЗрж░ рж╕ржорж╕рзНржпрж╛рж╕ржорзВрж╣","ржжрж░рж┐ржжрзНрж░ржжрзЗрж░ ржХрж▓рзНржпрж╛ржгрзЗ ржирзАрждрж┐ржорж╛рж▓рж╛","ржжрж░рж┐ржжрзНрж░ ржмрж┐ржорзЛржЪржирзЗрж░ ржмрж┐ржнрж┐ржирзНржи ржкржжрзНржзрждрж┐","ржжрж░рж┐ржжрзНрж░ржжрзЗрж░ ржЬржирзНржп рж╕рж░ржХрж╛рж░рзА ржУ ржмрзЗрж╕рж░ржХрж╛рж░рзА ржЙржжрзНржпрзЛржЧ","рж╕рж╛ржорж╛ржЬрж┐ржХ ржирж┐рж░рж╛ржкрждрзНрждрж╛ ржмрзНржпржмрж╕рзНржерж╛","ржжрж░рж┐ржжрзНрж░ржжрзЗрж░ ржХрзНрж╖ржорждрж╛рзЯржи ржУ рж╕рж╛ржорж╛ржЬрж┐ржХ ржЕржирзНрждрж░рзНржнрзБржХрзНрждрж┐","ржжрж░рж┐ржжрзНрж░ржжрзЗрж░ ржЬрзАржмржиржорж╛ржи ржЙржирзНржирзЯржирзЗ рж╕ржорж╛ржЬржХрж░рзНржорзЗрж░ ржнрзВржорж┐ржХрж╛","ржХрж╛рж░рзНржпржХрж░ ржкрж░рж┐ржХрж▓рзНржкржирж╛ ржУ ржкрзНрж░рзЛржЧрзНрж░рж╛ржо ржмрж╛рж╕рзНрждржмрж╛рзЯржи","ржжрж░рж┐ржжрзНрж░рждрж╛ ржирж┐рж░рж╕ржирзЗ ржЖржирзНрждрж░рзНржЬрж╛рждрж┐ржХ рж╕рж╣ржпрзЛржЧрж┐рждрж╛"]},{"name":"ржкрзНрж░ржХрж▓рзНржк ржкрж░рж┐ржХрж▓рзНржкржирж╛ ржУ ржмрзНржпржмрж╕рзНржерж╛ржкржирж╛ (ржкрзЗржкрж╛рж░ ржХрзЛржб : 232109)","chapters":["ржкрзНрж░ржХрж▓рзНржк ржкрж░рж┐ржХрж▓рзНржкржирж╛рж░ ржзрж╛рж░ржгрж╛ ржУ ржЧрзБрж░рзБрждрзНржм","ржкрзНрж░ржХрж▓рзНржк ржкрж░рж┐ржХрж▓рзНржкржирж╛ ржкрзНрж░ржХрзНрж░рж┐рзЯрж╛","ржкрзНрж░ржХрж▓рзНржкрзЗрж░ рж▓ржХрзНрж╖рзНржп ржирж┐рж░рзНржзрж╛рж░ржг","ржмрж╛ржЬрзЗржЯ ржУ рж╕ржорзНржкржж ржкрж░рж┐ржХрж▓рзНржкржирж╛","ржкрзНрж░ржХрж▓рзНржк ржмрж╛рж╕рзНрждржмрж╛рзЯржи ржУ ржирж┐рзЯржирзНрждрзНрж░ржг","ржкрзНрж░ржХрж▓рзНржк ржмрзНржпржмрж╕рзНржерж╛ржкржирж╛рж░ ржХрзМрж╢рж▓","ржкрзНрж░ржХрж▓рзНржк ржорзВрж▓рзНржпрж╛рзЯржи ржУ ржоржирж┐ржЯрж░рж┐ржВ","рж╕ржорж╕рзНржпрж╛ рж╕ржорж╛ржзрж╛ржи ржУ ржЭрзБржБржХрж┐ ржмрзНржпржмрж╕рзНржерж╛ржкржирж╛","ржжрж▓ ржУ ржирзЗрждрзГрждрзНржм ржЙржирзНржирзЯржи","ржкрзНрж░ржХрж▓рзНржкрзЗрж░ рж╕ржлрж▓рждрж╛ ржУ ржмрзНржпрж░рзНржерждрж╛рж░ ржХрж╛рж░ржг"]},{"name":"ржЬржирж╕ржВржЦрзНржпрж╛ ржЗрж╕рзНржпрзБ , ржирзАрждрж┐ ржкрж░рж┐ржХрж▓рзНржкржирж╛ ржУ рж╕рзЗржмрж╛ (ржкрзЗржкрж╛рж░ ржХрзЛржб : 232111)","chapters":["ржЬржирж╕ржВржЦрзНржпрж╛рж░ ржзрж╛рж░ржгрж╛ ржУ ржмрзИрж╢рж┐рж╖рзНржЯрзНржп","ржЬржирж╕ржВржЦрзНржпрж╛рж░ ржмрзГржжрзНржзрж┐ ржУ ржПрж░ ржкрзНрж░ржнрж╛ржм","ржЬржирж╕ржВржЦрзНржпрж╛ рж╕ржорж╕рзНржпрж╛ ржУ рж╕ржорж╛ржзрж╛ржи","ржЬржирж╕ржВржЦрзНржпрж╛ ржирзАрждрж┐ ржУ ржкрж░рж┐ржХрж▓рзНржкржирж╛","ржкрж░рж┐ржмрж╛рж░ ржкрж░рж┐ржХрж▓рзНржкржирж╛ ржУ рж╕рзНржмрж╛рж╕рзНржерзНржп рж╕рзЗржмрж╛","ржЬржирж╕ржВржЦрзНржпрж╛ ржУ ржЕрж░рзНржержирзИрждрж┐ржХ ржЙржирзНржирзЯржи","ржЬржирж╕ржВржЦрзНржпрж╛рж░ ржмрзЯрж╕рзНржХржХрж░ржг ржУ рждрж╛рж░ ржкрзНрж░ржнрж╛ржм","рж╢рж┐рж╢рзБрж╕ржВржЦрзНржпрж╛ ржУ рж╢рж┐ржХрзНрж╖рж╛","ржЬржирж╕ржВржЦрзНржпрж╛ рж╕рзНржмрж╛рж╕рзНржерзНржп рж╕рзЗржмрж╛ ржмрзНржпржмрж╕рзНржерж╛ржкржирж╛","ржЖржирзНрждрж░рзНржЬрж╛рждрж┐ржХ ржЬржирж╕ржВржЦрзНржпрж╛ рж╕ржорж╕рзНржпрж╛ ржУ ржЙржжрзНржпрзЛржЧ"]},{"name":"ржорж╛ржиржмрж╛ржзрж┐ржХрж╛рж░ , рж╕рж╛ржорж╛ржЬрж┐ржХ ржирзНржпрж╛ржпрж╝ржмрж┐ржЪрж╛рж░ ржУ рж╕ржорж╛ржЬржХрж░рзНржо (ржкрзЗржкрж╛рж░ ржХрзЛржб : 232113)","chapters":["ржорж╛ржиржмрж╛ржзрж┐ржХрж╛рж░ : рж╕ржВржЬрзНржЮрж╛ ржУ ржкрзНрж░ржХрж╛рж░ржнрзЗржж","рж╕рж╛ржорж╛ржЬрж┐ржХ ржирзНржпрж╛ржпрж╝ржмрж┐ржЪрж╛рж░рзЗрж░ ржзрж╛рж░ржгрж╛","ржорж╛ржиржмрж╛ржзрж┐ржХрж╛рж░ ржУ рж╕ржорж╛ржЬржХрж░рзНржорзЗрж░ рж╕ржорзНржкрж░рзНржХ","ржЖржирзНрждрж░рзНржЬрж╛рждрж┐ржХ ржорж╛ржиржмрж╛ржзрж┐ржХрж╛рж░ ржЖржЗржи ржУ ржЪрзБржХрзНрждрж┐","ржорж╛ржиржмрж╛ржзрж┐ржХрж╛рж░ рж▓ржЩрзНржШржи ржУ ржкрзНрж░рждрж┐ржХрж╛рж░","рж╕ржорж╛ржЬржХрж░рзНржорзЗ ржирзНржпрж╛ржпрж╝ржмрж┐ржЪрж╛рж░рзЗрж░ ржкрзНрж░рзЯрзЛржЧ","рж╕ржорж╛ржЬрзЗ ржмрзИрж╖ржорзНржп ржУ ржорж╛ржиржмрж╛ржзрж┐ржХрж╛рж░","ржирж╛рж░рзА ржУ рж╢рж┐рж╢рзБ ржЕржзрж┐ржХрж╛рж░рзЗрж░ рж╕рзБрж░ржХрзНрж╖рж╛","ржкрзНрж░рждрж┐ржмржирзНржзрзА ржУ рж╕ржВржЦрзНржпрж╛рж▓ржШрзБрж░ ржЕржзрж┐ржХрж╛рж░","ржорж╛ржиржмрж╛ржзрж┐ржХрж╛рж░ рж╕ржВрж░ржХрзНрж╖ржгрзЗ ржПржиржЬрж┐ржУ ржУ рж╕рж░ржХрж╛рж░рзА ржнрзВржорж┐ржХрж╛"]},{"name":"ржЕржкрж░рж╛ржз ржУ рж╕ржорж╛ржЬ (ржкрзЗржкрж╛рж░ ржХрзЛржб : 232115)","chapters":["ржЕржкрж░рж╛ржзрзЗрж░ ржзрж╛рж░ржгрж╛ ржУ ржкрзНрж░ржХрж╛рж░ржнрзЗржж","ржЕржк ржЕржкрж░рж╛ржзрзЗрж░ рж╕рж╛ржорж╛ржЬрж┐ржХ ржУ ржоржирзЛржмрзИржЬрзНржЮрж╛ржирж┐ржХ ржХрж╛рж░ржг","ржЕржкрж░рж╛ржзрзА ржмрзНржпржХрзНрждрж┐рждрзНржм ржУ рж╕ржорж╛ржЬрзЗрж░ ржкрзНрж░ржнрж╛ржм","ржЕржк ржЕржкрж░рж╛ржзрзЗрж░ ржмрж┐ржЪрж╛рж░ ржмрзНржпржмрж╕рзНржерж╛","ржЕржк ржЕржкрж░рж╛ржз ржкрзНрж░рждрж┐рж░рзЛржз ржУ ржирж┐ржпрж╝ржирзНрждрзНрж░ржг ржмрзНржпржмрж╕рзНржерж╛","ржкрзБржирж░рзНржмрж╛рж╕ржи ржУ рж╕ржорж╛ржЬржХрж░рзНржорзЗрж░ ржнрзВржорж┐ржХрж╛","ржпрзБржм ржЕржкрж░рж╛ржз ржУ рждрж╛рж░ ржкрзНрж░рждрж┐ржХрж╛рж░","ржирж╛рж░рзАрж░ ржмрж┐рж░рзБржжрзНржзрзЗ ржЕржкрж░рж╛ржз","ржорж╛ржжржХрж╛рж╕ржХрзНрждрж┐ ржУ ржЕржкрж░рж╛ржз","ржЖржирзНрждрж░рзНржЬрж╛рждрж┐ржХ ржЕржкрж░рж╛ржз ржУ ржЕржкрж░рж╛ржз ржжржоржи ржирзАрждрж┐"]}],
      "4th Year":[{"name":"ржЧрзНрж░рж╛ржорзАржг ржУ рж╢рж╣рж░ рж╕ржорзНржкрзНрж░ржжржжрж╛рзЯ ржЙржирзНржирзЯржи (ржкрзЗржкрж╛рж░ ржХрзЛржб : 242101)","chapters":["ржЧрзНрж░рж╛ржорзАржг ржУ рж╢рж╣рж░ рж╕ржорзНржкрзНрж░ржжрж╛ржпрж╝рзЗрж░ рж╕ржВржЬрзНржЮрж╛ ржУ ржмрзИрж╢рж┐рж╖рзНржЯрзНржп","ржЧрзНрж░рж╛ржорзАржг ржЙржирзНржиржпрж╝ржирзЗрж░ рждрж╛рждрзНрждрзНржмрж┐ржХ ржнрж┐рждрзНрждрж┐","рж╢рж╣рж░ ржЙржирзНржиржпрж╝ржи ржУ ржиржЧрж░рж╛ржпрж╝ржи","ржЧрзНрж░рж╛ржорзАржг ржЕрж░рзНржержирзАрждрж┐ ржУ рж╕рж╛ржорж╛ржЬрж┐ржХ ржХрж╛ржарж╛ржорзЛ","рж╕рзНржерж╛ржирзАржпрж╝ ржкрзНрж░рждрж┐рж╖рзНржарж╛ржи ржУ ржирзЗрждрзГрждрзНржм","рж╕ржорзНржкрзНрж░ржжрж╛ржпрж╝ рж╕ржВржЧржаржи ржУ рж╕ржХрзНрж╖ржорждрж╛ ржмрзГржжрзНржзрж┐","ржкрж░рж┐ржХрж▓рзНржкржирж╛ ржУ рж╕ржорзНржкрзНрж░ржжрж╛ржпрж╝ ржЙржирзНржиржпрж╝ржи ржкржжрзНржзрждрж┐","рж╕рзНржерж╛ржирзАржпрж╝ рж╕рж░ржХрж╛рж░ ржУ ржЙржирзНржиржпрж╝ржи","рж╕рж╛ржорж╛ржЬрж┐ржХ ржкрж░рж┐ржмрж░рзНрждржи ржУ ржкрзНрж░ржпрзБржХрзНрждрж┐ ржЧрзНрж░рж╣ржг","ржмрж╛ржВрж▓рж╛ржжрзЗрж╢рзЗрж░ ржЧрзНрж░рж╛ржорзАржг ржУ рж╢рж╣рж░ ржЙржирзНржиржпрж╝ржирзЗрж░ ржмрж╛рж╕рзНрждржмрждрж╛"]},{"name":"ржЬрж▓ржмрж╛рзЯрзБ ржкрж░рж┐ржмрж░рзНрждржи : ржЗрж╕рзНржпрзБ ржУ ржжрзБрж░рзНржпрзЛржЧ ржмрзНржпржмрж╕рзНржерж╛ржкржирж╛ (ржкрзЗржкрж╛рж░ ржХрзЛржб : 242103)","chapters":["ржЬрж▓ржмрж╛ржпрж╝рзБ ржкрж░рж┐ржмрж░рзНрждржирзЗрж░ ржзрж╛рж░ржгрж╛ ржУ ржХрж╛рж░ржг","ржмрзИрж╢рзНржмрж┐ржХ ржУ рж╕рзНржерж╛ржирзАржпрж╝ ржЬрж▓ржмрж╛ржпрж╝рзБ ржкрж░рж┐ржмрж░рзНрждржи","ржкрзНрж░рж╛ржХрзГрждрж┐ржХ ржжрзБрж░рзНржпрзЛржЧрзЗрж░ ржкрзНрж░ржХрж╛рж░ржнрзЗржж","ржжрзБрж░рзНржпрзЛржЧ ржмрзНржпржмрж╕рзНржерж╛ржкржирж╛рж░ ржзрж╛ржк ржУ ржХрзМрж╢рж▓","ржЭрзБржБржХрж┐ ржорзВрж▓рзНржпрж╛ржпрж╝ржи ржУ ржЭрзБржБржХрж┐ ржмрзНржпржмрж╕рзНржерж╛ржкржирж╛","ржжрзБрж░рзНржпрзЛржЧ ржкрзНрж░рж╕рзНрждрзБрждрж┐ ржУ ржкрзНрж░рждрж┐рж░рзЛржз ржмрзНржпржмрж╕рзНржерж╛","ржжрзБрж░рзНржпрзЛржЧ ржерзЗржХрзЗ ржкрзБржирж░рзНржмрж╛рж╕ржи ржУ ржкрзБржирж░рзНржЧржаржи","ржЬрж▓ржмрж╛ржпрж╝рзБ ржкрж░рж┐ржмрж░рзНрждржи ржУ рж╕рж╛ржорж╛ржЬрж┐ржХ ржкрзНрж░ржнрж╛ржм","ржкрж░рж┐ржмрзЗрж╢ ржУ ржЯрзЗржХрж╕ржЗ ржЙржирзНржиржпрж╝ржи","ржмрж╛ржВрж▓рж╛ржжрзЗрж╢рзЗ ржжрзБрж░рзНржпрзЛржЧ ржмрзНржпржмрж╕рзНржерж╛ржкржирж╛ ржУ ржЪрзНржпрж╛рж▓рзЗржЮрзНржЬ"]},{"name":"ржорж╛ржиржм рж╕ржорзНржкржж ржмрзНржпржмрж╕рзНржерж╛ржкржирж╛ (ржкрзЗржкрж╛рж░ ржХрзЛржб : 242105)","chapters":["ржорж╛ржиржм рж╕ржорзНржкржжрзЗрж░ ржзрж╛рж░ржгрж╛ ржУ ржЧрзБрж░рзБрждрзНржм","ржорж╛ржиржм рж╕ржорзНржкржж ржкрж░рж┐ржХрж▓рзНржкржирж╛ ржУ ржмрж┐рж╢рзНрж▓рзЗрж╖ржг","ржХрж░рзНржорж╕ржВрж╕рзНржерж╛ржи ржУ ржЬржирж╢ржХрзНрждрж┐ ржЙржирзНржиржпрж╝ржи","ржкрзНрж░рж╢рж┐ржХрзНрж╖ржг ржУ ржХрж░рзНржорзА ржЙржирзНржирзЯржи","ржХрж░рзНржорзА ржорзВрж▓рзНржпрж╛ржпрж╝ржи ржУ ржкрж░рж┐ржжрж░рзНрж╢ржи","ржорж╛ржиржм рж╕ржорзНржкржж ржЙржирзНржирзЯржирзЗ ржкрзНрж░ржгрзЛржжржирж╛ ржУ ржкрзНрж░рзЗрж░ржгрж╛","ржХрж░рзНржорзА рж╕ржорзНржкрж░рзНржХ ржУ рж╕ржВржШрж░рзНрж╖ ржмрзНржпржмрж╕рзНржерж╛ржкржирж╛","ржирзЗрждрзГрждрзНржм ржУ ржкрж░рж┐ржЪрж╛рж▓ржирж╛ржпрж╝ ржорж╛ржиржм рж╕ржорзНржкржж","ржорж╛ржиржм рж╕ржорзНржкржж ржЙржирзНржирзЯржирзЗ ржкрзНрж░ржпрзБржХрзНрждрж┐рж░ ржмрзНржпржмрж╣рж╛рж░","ржмрж╛ржВрж▓рж╛ржжрзЗрж╢рзЗ ржорж╛ржиржм рж╕ржорзНржкржж ржмрзНржпржмрж╕рзНржерж╛ржкржирж╛рж░ ржЪрзНржпрж╛рж▓рзЗржЮрзНржЬ ржУ рж╕рзБржпрзЛржЧ"]},{"name":"рж╕рж╛ржорж╛ржЬрж┐ржХ ржЧржмрзЗрж╖ржгрж╛ ржУ ржкрж░рж┐рж╕ржВржЦрзНржпрж╛ржи (ржкрзЗржкрж╛рж░ ржХрзЛржб : 242107)","chapters":["рж╕рж╛ржорж╛ржЬрж┐ржХ ржЧржмрзЗрж╖ржгрж╛рж░ ржЙржжрзНржжрзЗрж╢рзНржп ржУ ржкрзНрж░ржХрж╛рж░ржнрзЗржж","ржЧржмрзЗрж╖ржгрж╛ ржкрж░рж┐ржХрж▓рзНржкржирж╛ ржУ ржиржХрж╢рж╛","рждржерзНржп рж╕ржВржЧрзНрж░рж╣рзЗрж░ ржкржжрзНржзрждрж┐","ржиржорзБржирж╛ ржЧрзНрж░рж╣ржг ржУ рждржерзНржп рж╕ржВржЧрзНрж░рж╣","рждржерзНржп ржмрж┐рж╢рзНрж▓рзЗрж╖ржг ржУ ржЙржкрж╕рзНржерж╛ржкржи","ржЧрзБржгржЧржд ржУ ржкрж░рж┐ржорж╛ржгржЧржд ржЧржмрзЗрж╖ржгрж╛ ржкржжрзНржзрждрж┐","ржкрж░рж┐рж╕ржВржЦрзНржпрж╛ржирзЗрж░ ржорзМрж▓рж┐ржХ ржзрж╛рж░ржгрж╛","ржЙржкрж╛рждрзНржд ржмрж┐рж╢рзНрж▓рзЗрж╖ржгрзЗрж░ ржкржжрзНржзрждрж┐ ( ржорж╛ржзрзНржпржо , ржмрж┐ржнрзНрж░рж╛ржЯ , ржХрж░рзЗрж▓рзЗрж╢ржи ржЗрждрзНржпрж╛ржжрж┐ )","ржЧржмрзЗрж╖ржгрж╛ржпрж╝ ржирзИрждрж┐ржХрждрж╛ ржУ рж╕рждрждрж╛","рж░рж┐ржкрзЛрж░рзНржЯ рж▓рзЗржЦрж╛ ржУ ржЙржкрж╕рзНржерж╛ржкржирж╛"]},{"name":"ржмрж╛ржВрж▓рж╛ржжрзЗрж╢рзЗ рж╕рж╛ржорж╛ржЬрж┐ржХ рж╕рзЗржмрж╛ (ржкрзЗржкрж╛рж░ ржХрзЛржб : 242109)","chapters":["рж╕рж╛ржорж╛ржЬрж┐ржХ рж╕рзЗржмрж╛рж░ ржзрж╛рж░ржгрж╛ ржУ ржкрзНрж░рзЯрзЛржЬржирзАрзЯрждрж╛","рж╕рж╛ржорж╛ржЬрж┐ржХ рж╕рзЗржмрж╛рж░ ржЗрждрж┐рж╣рж╛рж╕ ржУ ржЙржирзНржиржпрж╝ржи","рж╕рж╛ржорж╛ржЬрж┐ржХ рж╕рзЗржмрж╛рж░ ржмрж┐ржнрж┐ржирзНржи ржзрж░ржг","рж╕рж░ржХрж╛рж░рзА ржУ ржмрзЗрж╕рж░ржХрж╛рж░рзА рж╕рж╛ржорж╛ржЬрж┐ржХ рж╕рзЗржмрж╛ ржкрзНрж░рждрж┐рж╖рзНржарж╛ржи","рж╕рж╛ржорж╛ржЬрж┐ржХ рж╕рзЗржмрж╛рж░ ржХрж╛рж░рзНржпржХрзНрж░ржо ржУ ржкрж░рж┐ржХрж▓рзНржкржирж╛","рж╕рж╛ржорж╛ржЬрж┐ржХ рж╕рзЗржмрж╛рж░ ржЬржиржмрж▓ ржУ ржкрзНрж░рж╢рж┐ржХрзНрж╖ржг","рж╕ржорж╛ржЬржХрж▓рзНржпрж╛ржг ржХрж╛рж░рзНржпржХрзНрж░ржо ржУ ржкрзНрж░ржнрж╛ржм","рж╕рж╛ржорж╛ржЬрж┐ржХ рж╕рзЗржмрж╛рж░ ржУ ржжрж╛рж░рж┐ржжрзНрж░рзНржп ржмрж┐ржорзЛржЪржи","ржмрж╛ржВрж▓рж╛ржжрзЗрж╢рзЗрж░ рж╕рж╛ржорж╛ржЬрж┐ржХ рж╕рзЗржмрж╛ ржирзАрждрж┐ ржУ ржЖржЗржи","рж╕рж╛ржорж╛ржЬрж┐ржХ рж╕рзЗржмрж╛ржпрж╝ ржЪрзНржпрж╛рж▓рзЗржЮрзНржЬ ржУ ржнржмрж┐рж╖рзНржпрзО рж╕ржорзНржнрж╛ржмржирж╛"]},{"name":"рж╕ржорж╛ржЬржХрж░рзНржо ржУ ржмрзИрж╢рзНржмрж┐ржХрж░ржг (ржкрзЗржкрж╛рж░ ржХрзЛржб : 242111)","chapters":["ржмрзИрж╢рзНржмрж┐ржХрж░ржг : ржзрж╛рж░ржгрж╛ ржУ ржкрзНрж░ржнрж╛ржм","ржмрзИрж╢рзНржмрж┐ржХ ржЕрж░рзНржержирзАрждрж┐ ржУ рж╕рж╛ржорж╛ржЬрж┐ржХ ржкрж░рж┐ржмрж░рзНрждржи","ржмрзИрж╢рзНржмрж┐ржХ рж╕ржВрж╕рзНржерж╛ ржУ рждрж╛ржжрзЗрж░ ржнрзВржорж┐ржХрж╛","ржмрзИрж╢рзНржмрж┐ржХрж╛рзЯржирзЗ рж╕ржорж╛ржЬржХрж░рзНржорзЗрж░ ржкрзНрж░рзЯрзЛржЬржирзАрзЯрждрж╛","ржмрзИрж╢рзНржмрж┐ржХ ржорж╛ржиржмрж╛ржзрж┐ржХрж╛рж░ ржУ рж╕рж╛ржорж╛ржЬрж┐ржХ ржирзНржпрж╛рзЯржмрж┐ржЪрж╛рж░","ржмрзИрж╢рзНржмрж┐ржХ рж╕ржВржХржЯ ржУ ржжрзБрж░рзНржпрзЛржЧ ржмрзНржпржмрж╕рзНржерж╛ржкржирж╛","ржмрзИрж╢рзНржмрж┐ржХрж╛рзЯржи ржУ рж╕рзНржерж╛ржирзАржпрж╝ рж╕ржорзНржкрзНрж░ржжрж╛ржпрж╝","рж╕ржорж╛ржЬржХрж░рзНржорзЗ ржкрзНрж░ржпрзБржХрзНрждрж┐рж░ ржмрзНржпржмрж╣рж╛рж░","ржЖржирзНрждрж░рзНржЬрж╛рждрж┐ржХ ржЙржирзНржиржпрж╝ржи рж╕рж╣ржпрзЛржЧрж┐рждрж╛","ржмрж╛ржВрж▓рж╛ржжрзЗрж╢рзЗ ржмрзИрж╢рзНржмрж┐ржХрж╛рзЯржирзЗрж░ ржкрзНрж░ржнрж╛ржм ржУ рж╕ржорж╛ржЬржХрж░рзНржо"]},{"name":"ржЬржирж╕рзНржмрж╛рж╕рзНржерзНржп ржУ рж╕ржорж╛ржЬржХрж░рзНржо (ржкрзЗржкрж╛рж░ ржХрзЛржб : 232113 / 242113)","chapters":["ржЬржирж╕рзНржмрж╛рж╕рзНржерзНржпрзЗрж░ ржкрж░рж┐ржЪрж┐рждрж┐ ржУ ржЧрзБрж░рзБрждрзНржм","рж╕рзНржмрж╛рж╕рзНржерзНржп ржУ рж╕рж╛ржорж╛ржЬрж┐ржХ determinants","рж░рзЛржЧ ржкрзНрж░рждрж┐рж░рзЛржз ржУ рж╕рзНржмрж╛рж╕рзНржерзНржпрж╕рзЗржмрж╛ ржмрзНржпржмрж╕рзНржерж╛","ржЬржирж╕рзНржмрж╛рж╕рзНржерзНржп ржкрж░рж┐ржХрж▓рзНржкржирж╛ ржУ ржирзАрждрж┐","рж╕ржорж╛ржЬржХрж░рзНржорзЗрж░ ржорж╛ржзрзНржпржорзЗ рж╕рзНржмрж╛рж╕рзНржерзНржпрж╕рзЗржмрж╛ ржкрзНрж░ржжрж╛ржи","рж╕рзНржмрж╛рж╕рзНржерзНржп рж╢рж┐ржХрзНрж╖рж╛ ржУ рж╕ржорзНржкрзНрж░ржжрж╛ржпрж╝ ржнрж┐рждрзНрждрж┐ржХ ржЙржжрзНржпрзЛржЧ","рж╢рж┐рж╢рзБ , ржирж╛рж░рзА ржУ ржмрзГржжрзНржз рж╕рзНржмрж╛рж╕рзНржерзНржп","ржорж╛ржирж╕рж┐ржХ рж╕рзНржмрж╛рж╕рзНржерзНржп ржУ рж╕ржорж╛ржЬржХрж░рзНржо","рж╕рзНржмрж╛рж╕рзНржерзНржп рж╕ржорзНржкрж░рзНржХрж┐ржд рж╕рж╛ржорж╛ржЬрж┐ржХ рж╕ржорж╕рзНржпрж╛","ржмрж╛ржВрж▓рж╛ржжрзЗрж╢рзЗрж░ ржЬржирж╕рзНржмрж╛рж╕рзНржерзНржп : ржЪрзНржпрж╛рж▓рзЗржЮрзНржЬ ржУ ржЙржирзНржирзЯржи"]},{"name":"рж╕рж╛ржорж╛ржЬрж┐ржХ ржХрж░рзНржо , ржЖржЗржи ржУ рж╕ржорж╛ржЬржХрж░рзНржо (ржкрзЗржкрж╛рж░ ржХрзЛржб : 242115)","chapters":["рж╕рж╛ржорж╛ржЬрж┐ржХ ржХрж░рзНржорзЗрж░ ржзрж╛рж░ржгрж╛ ржУ ржкрзНрж░ржХрж╛рж░ржнрзЗржж","рж╕рж╛ржорж╛ржЬрж┐ржХ ржХрж░рзНржо ржУ ржЖржЗржи : рж╕ржорзНржкрж░рзНржХ ржУ ржкрзНрж░ржнрж╛ржм","ржорж╛ржиржмрж╛ржзрж┐ржХрж╛рж░ ржУ ржЖржЗржи","рж╕рж╛ржорж╛ржЬрж┐ржХ ржирзАрждрж┐ ржУ ржЖржЗржи ржкрзНрж░ржгрзЯржи","рж╕ржорж╛ржЬржХрж░рзНржорзЗ ржЖржЗржирж┐ рж╕рж╛рж╣рж╛ржпрзНржпрзЗрж░ ржнрзВржорж┐ржХрж╛","ржжржгрзНржбржмрж┐ржзрж┐ ржУ рж╕ржорж╛ржЬржХрж░рзНржо","рж╢рж┐рж╢рзБ ржЕржзрж┐ржХрж╛рж░ ржЖржЗржи ржУ рж╕ржорж╛ржЬржХрж░рзНржо","ржирж╛рж░рзАрж░ ржмрж┐рж░рзБржжрзНржзрзЗ рж╕рж╣рж┐ржВрж╕рждрж╛ ржУ ржЖржЗржи","ржЖржЗржиржЧржд рж╕рзЗржмрж╛ ржкрзНрж░ржжрж╛ржи ржкржжрзНржзрждрж┐","ржмрж╛ржВрж▓рж╛ржжрзЗрж╢рзЗрж░ рж╕рж╛ржорж╛ржЬрж┐ржХ ржХрж░рзНржо ржУ ржЖржЗржиржЧржд ржХрж╛ржарж╛ржорзЛ"]},{"name":"ржорж╛ржаржХрж░рзНржо рж╢рж┐ржХрзНрж╖рж╛ (Field Work Education) (ржкрзЗржкрж╛рж░ ржХрзЛржб : 242117)","chapters":["ржорж╛ржаржХрж░рзНржорзЗрж░ ржЙржжрзНржжрзЗрж╢рзНржп ржУ ржЧрзБрж░рзБрждрзНржм","ржорж╛ржаржХрж░рзНржо ржкрж░рж┐ржХрж▓рзНржкржирж╛ ржУ ржкрзНрж░рж╕рзНрждрзБрждрж┐","ржХрзНрж▓рж╛ржпрж╝рзЗржирзНржЯ рж╕рж┐рж╕рзНржЯрзЗржо ржЪрж┐рж╣рзНржирж┐рждржХрж░ржг","рждржерзНржп рж╕ржВржЧрзНрж░рж╣ ржУ ржорзВрж▓рзНржпрж╛ржпрж╝ржи","ржкрж░рж┐рж╖рзЗржмрж╛ ржкрзНрж░ржжрж╛ржи ржУ ржкрж░рж┐ржЪрж╛рж▓ржирж╛","ржжрж▓ ржУ рж╕рзБржкрж╛рж░ржнрж┐рж╢ржи","ржкрзНрж░рждрж┐ржмрзЗржжржи рж▓рзЗржЦрж╛ ржУ ржЙржкрж╕рзНржерж╛ржкржи","ржирзИрждрж┐ржХрждрж╛ ржУ ржкрзЗрж╢рж╛ржЧржд ржжрж╛ржпрж╝рж┐рждрзНржм","рж╕ржорж╕рзНржпрж╛ рж╕ржорж╛ржзрж╛ржи ржУ рж╕рж┐ржжрзНржзрж╛ржирзНржд ржЧрзНрж░рж╣ржг","ржорж╛ржаржХрж░рзНржорзЗрж░ ржорзВрж▓рзНржпрж╛ржпрж╝ржи ржУ ржкрзНрж░рждрж┐ржХрзНрж░рж┐ржпрж╝рж╛"]},{"name":"ржорж╛ржаржХрж░рзНржо ржХрж╛рж░рзНржпржХрзНрж░ржо ржУ ржнрж╛ржЗржнрж╛ (Field Practicum + Viva Voce) (ржкрзЗржкрж╛рж░ ржХрзЛржб : 242118)","chapters":["ржорж╛ржаржХрж░рзНржо ржХрж╛рж░рзНржпржХрзНрж░ржорзЗрж░ ржмрж╛рж╕рзНрждржмрж╛рзЯржи","ржХрзНрж▓рж╛ржпрж╝рзЗржирзНржЯ ржУ рж╕ржорзНржкрзНрж░ржжрж╛ржпрж╝рзЗрж░ рж╕рж╛ржерзЗ ржХрж╛ржЬ","ржорж╛ржаржХрж░рзНржо ржкрзНрж░рждрж┐ржмрзЗржжржи ржкрзНрж░рж╕рзНрждрзБрждрж┐","рж╕ржорж╕рзНржпрж╛ ржУ рж╕ржорж╛ржзрж╛ржирзЗрж░ ржмрж┐рж╢рзНрж▓рзЗрж╖ржг","рж╕рзБржкрж╛рж░ржнрж╛ржЗржЬрж╛рж░ ржУ ржкрж┐ржпрж╝рж╛рж░ ржлрж┐ржбржмрзНржпрж╛ржХ","ржнрж╛ржЗржнрж╛ ржкрзНрж░рж╕рзНрждрзБрждрж┐ ржУ ржкрзНрж░рж╢рзНржирзЛрждрзНрждрж░","ржкрзЗрж╢рж╛ржЧржд ржЖржЪрж░ржг ржУ ржорзВрж▓рзНржпрж╛ржпрж╝ржи","ржХрж╛ржЬрзЗрж░ ржирзИрждрж┐ржХрждрж╛ ржУ рж╕рж╛ржорж╛ржЬрж┐ржХ ржжрж╛рзЯржмржжрзНржзрждрж╛","ржХрзНрж╖рзЗрждрзНрж░ ржЕржнрж┐ржЬрзНржЮрждрж╛ ржерзЗржХрзЗ рж╢рж┐ржХрзНрж╖рж╛","ржнржмрж┐рж╖рзНржпржд ржкрж░рж┐ржХрж▓рзНржкржирж╛ ржУ ржжрж┐ржХржирж┐рж░рзНржжрзЗрж╢ржирж╛"]}],
      "Others":[{"name":"ржЗржВрж░рзЗржЬрж┐ (English)","chapters":["Grammar: Parts of Speech","Sentence Structure ржУ Types of Sentences","Tenses (Present, Past, Future)","Active and Passive Voice","Direct and Indirect Speech","Articles, Prepositions, Conjunctions","Vocabulary Development (Synonyms, Antonyms, Homonyms)","Composition Writing (Paragraph, Letter Writing)","Comprehension (Reading and Understanding passages)","Translation ( ржмрж╛ржВрж▓рж╛ ржерзЗржХрзЗ ржЗржВрж░рзЗржЬрж┐ )","Essay Writing (Narrative, Descriptive, Argumentative)","Precis Writing","Letter Writing (Formal and Informal)","Report Writing","Dialogue Writing","Reading Comprehension (Unseen passages)","Literature: Short Stories / Poems / Drama (Selected texts)","Use of Idioms and Phrases","Summary Writing","Translation ( ржЗржВрж░рзЗржЬрж┐ ржерзЗржХрзЗ ржмрж╛ржВрж▓рж╛ )"]}]
    };

    // --- Helpers ---
    function debounce(fn, delay = 300) {
      let t; return (...args) => { clearTimeout(t); t = setTimeout(() => fn(...args), delay); };
    }

    async function fetchWithRetry(url, options) {
      const maxRetries = 3; let delay = 1000;
      for (let i = 0; i < maxRetries; i++) {
        try {
          const res = await fetch(url, options);
          if (!res.ok) {
             const errText = await res.text();
             throw new Error(`API Error: ${res.status} ${errText}`);
          }
          return res;
        } catch (e) {
          if (i === maxRetries - 1) throw e;
          await new Promise(r => setTimeout(r, delay)); delay *= 2;
        }
      }
    }

    function toast(message, type = 'info') {
      const container = document.getElementById('toast-container');
      const el = document.createElement('div');
      const baseClass = "transform transition-all duration-300 ease-out translate-y-2 opacity-0 flex items-center gap-3 shadow-xl rounded-xl px-5 py-4 max-w-sm border-l-4";
      let colors = type === 'error' ? "bg-white text-gray-800 border-red-500" : (type === 'success' ? "bg-white text-gray-800 border-green-500" : "bg-gray-800 text-white border-gray-600");
      el.className = `${baseClass} ${colors}`;
      el.innerHTML = `<p class="text-sm font-medium">${message}</p>`;
      container.appendChild(el);
      requestAnimationFrame(() => el.classList.remove('translate-y-2', 'opacity-0'));
      setTimeout(() => { el.classList.add('translate-y-2', 'opacity-0'); setTimeout(() => container.removeChild(el), 300); }, 3000);
    }

    async function copyToClipboard(text) {
      try { await navigator.clipboard.writeText(text); toast('ржХржкрж┐ ржХрж░рж╛ рж╣рзЯрзЗржЫрзЗ', 'success'); } catch { toast('ржХржкрж┐ ржХрж░рж╛ ржпрж╛рзЯржирж┐', 'error'); }
    }

    function updateSavedCountBadge() {
      const badge = document.getElementById('saved-count-badge');
      const saved = JSON.parse(localStorage.getItem(LS_KEY_SAVED)) || [];
      badge.textContent = saved.length;
      badge.classList.remove('scale-125'); requestAnimationFrame(() => badge.classList.add('scale-100')); 
    }

    // --- DOM Elements ---
    const generateBtn = document.getElementById('generate-btn');
    const btnText = document.getElementById('btn-text');
    const loader = document.getElementById('loader');
    const resultContainer = document.getElementById('result-container');
    const yearSelect = document.getElementById('year-select');
    const subjectSelect = document.getElementById('subject-select');
    const chapterSelect = document.getElementById('chapter-select');

    // Tabs
    const tabBtns = { 
      generate: document.getElementById('tab-btn-generate'), 
      tracker: document.getElementById('tab-btn-tracker'),
      collection: document.getElementById('tab-btn-collection') 
    };
    const tabContents = { 
      generate: document.getElementById('tab-content-generate'), 
      tracker: document.getElementById('tab-content-tracker'),
      collection: document.getElementById('tab-content-collection') 
    };
    const collectionContainer = document.getElementById('collection-container');

    // --- Tab Logic ---
    function switchTab(activeTabName) {
      Object.keys(tabBtns).forEach(name => {
        const btn = tabBtns[name];
        if (name === activeTabName) {
          btn.classList.add('tab-active', 'text-primary-700', 'bg-primary-50'); btn.classList.remove('tab-inactive', 'text-gray-500'); btn.setAttribute('aria-selected', 'true');
        } else {
          btn.classList.remove('tab-active', 'text-primary-700', 'bg-primary-50'); btn.classList.add('tab-inactive', 'text-gray-500'); btn.setAttribute('aria-selected', 'false');
        }
      });
      Object.keys(tabContents).forEach(name => {
        const content = tabContents[name];
        if (name === activeTabName) {
          content.classList.remove('hidden'); content.classList.add('animate-slide-up');
        } else {
          content.classList.add('hidden'); content.classList.remove('animate-slide-up');
        }
      });
      if (activeTabName === 'collection') renderSavedQuestions();
      if (activeTabName === 'tracker') initTracker();
    }
    Object.keys(tabBtns).forEach(name => { tabBtns[name].addEventListener('click', () => switchTab(name)); });
    document.getElementById('header-saved-btn')?.addEventListener('click', () => switchTab('collection'));

    // --- Dropdown Logic ---
    function populateYears() {
      Object.keys(subjectData).forEach(year => {
        const bn = year === '1st Year' ? 'рззржо ржмрж░рзНрж╖' : year === '2nd Year' ? 'рзирзЯ ржмрж░рзНрж╖' : year === '3rd Year' ? 'рзйрзЯ ржмрж░рзНрж╖' : year === '4th Year' ? 'рзкрж░рзНрже ржмрж░рзНрж╖' : 'ржЕржирзНржпрж╛ржирзНржп';
        yearSelect.add(new Option(`${year} (${bn})`, year));
      });
    }
    function populateSubjects(year) {
      subjectSelect.innerHTML = '<option value=""> </option>'; chapterSelect.innerHTML = '<option value=""> </option>';
      subjectSelect.disabled = true; chapterSelect.disabled = true; generateBtn.disabled = true;
      if(year) { subjectData[year].forEach(s => subjectSelect.add(new Option(s.name, s.name))); subjectSelect.disabled = false; }
    }
    function populateChapters(year, subjectName) {
      chapterSelect.innerHTML = '<option value=""> </option>'; chapterSelect.disabled = true; generateBtn.disabled = true;
      if(year && subjectName) {
        const sub = subjectData[year].find(s => s.name === subjectName);
        if(sub) { sub.chapters.forEach(c => chapterSelect.add(new Option(c, c))); chapterSelect.disabled = false; }
      }
    }
    yearSelect.addEventListener('change', () => { populateSubjects(yearSelect.value); localStorage.setItem(LS_KEY_YEAR, yearSelect.value); });
    subjectSelect.addEventListener('change', () => { populateChapters(yearSelect.value, subjectSelect.value); localStorage.setItem(LS_KEY_SUBJECT, subjectSelect.value); });
    chapterSelect.addEventListener('change', () => { const val = chapterSelect.value; generateBtn.disabled = !val; if(val) localStorage.setItem(LS_KEY_CHAPTER, val); });

    // --- Load State ---
    window.addEventListener('DOMContentLoaded', () => {
      populateYears();
      const sYear = localStorage.getItem(LS_KEY_YEAR);
      if(sYear) {
        yearSelect.value = sYear; populateSubjects(sYear);
        const sSub = localStorage.getItem(LS_KEY_SUBJECT);
        if(sSub && subjectSelect.querySelector(`option[value="${sSub}"]`)) {
          subjectSelect.value = sSub; populateChapters(sYear, sSub);
          const sChap = localStorage.getItem(LS_KEY_CHAPTER);
          if(sChap && chapterSelect.querySelector(`option[value="${sChap}"]`)) { chapterSelect.value = sChap; generateBtn.disabled = false; }
        }
      }
      const genHtml = localStorage.getItem(LS_KEY_QUESTION_GEN);
      if(genHtml && genHtml.includes('card')) resultContainer.innerHTML = genHtml;
      
      updateSavedCountBadge();
    });

    // --- SYLLABUS TRACKER LOGIC ---
    function initTracker() {
      const yearFilter = document.getElementById('tracker-year-filter');
      if (yearFilter.options.length === 0) {
        Object.keys(subjectData).forEach(year => {
           const bn = year === '1st Year' ? 'рззржо ржмрж░рзНрж╖' : year === '2nd Year' ? 'рзирзЯ ржмрж░рзНрж╖' : year === '3rd Year' ? 'рзйрзЯ ржмрж░рзНрж╖' : year === '4th Year' ? 'рзкрж░рзНрже ржмрж░рзНрж╖' : 'ржЕржирзНржпрж╛ржирзНржп';
           yearFilter.add(new Option(`${year} (${bn})`, year));
        });
        const savedYear = localStorage.getItem(LS_KEY_YEAR) || '1st Year';
        yearFilter.value = savedYear;
        yearFilter.addEventListener('change', () => renderTrackerList(yearFilter.value));
      }
      renderTrackerList(yearFilter.value);
    }

    function renderTrackerList(selectedYear) {
      const container = document.getElementById('tracker-list-container');
      const subjects = subjectData[selectedYear] || [];
      const completedSet = new Set(JSON.parse(localStorage.getItem(LS_KEY_SYLLABUS)) || []);
      
      let totalChapters = 0;
      let completedChapters = 0;
      let html = '';
      
      if(subjects.length === 0) {
          container.innerHTML = '<div class="text-center text-gray-500 py-10">ржХрзЛржирзЛ рждржерзНржп ржкрж╛ржУрзЯрж╛ ржпрж╛рзЯржирж┐</div>';
          return;
      }

      subjects.forEach((sub, sIdx) => {
        let subCompletedCount = 0;
        const chaptersHtml = sub.chapters.map((chap, cIdx) => {
          const id = `${selectedYear}|${sub.name}|${chap}`;
          const isChecked = completedSet.has(id);
          totalChapters++;
          if(isChecked) { completedChapters++; subCompletedCount++; }
          return `
            <label class="checkbox-wrapper flex items-start gap-3 p-3 hover:bg-gray-50 rounded-lg cursor-pointer group transition-colors">
              <input type="checkbox" class="hidden" onchange="toggleChapter('${id}')" ${isChecked ? 'checked' : ''}>
              <div class="w-5 h-5 border-2 border-gray-300 rounded flex items-center justify-center transition-all bg-white group-hover:border-primary-400 mt-0.5">
                <svg class="w-3 h-3 text-white hidden pointer-events-none" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"></path></svg>
              </div>
              <span class="text-sm text-gray-700 ${isChecked ? 'line-through text-gray-400' : ''}">${chap}</span>
            </label>
          `;
        }).join('');

        const progressPercent = Math.round((subCompletedCount / sub.chapters.length) * 100) || 0;
        html += `
          <div class="bg-white border border-gray-100 rounded-2xl overflow-hidden shadow-sm">
            <div class="p-4 bg-gray-50 border-b border-gray-100 flex justify-between items-center cursor-pointer hover:bg-gray-100 transition-colors" onclick="this.nextElementSibling.classList.toggle('hidden'); this.querySelector('.arrow').classList.toggle('rotate-180')">
              <div class="flex-1">
                 <h3 class="font-bold text-gray-800 text-sm md:text-base">${sub.name}</h3>
                 <div class="flex items-center gap-2 mt-1">
                   <div class="w-24 bg-gray-200 rounded-full h-1.5"><div class="bg-primary-500 h-1.5 rounded-full" style="width: ${progressPercent}%"></div></div>
                   <span class="text-xs text-gray-500">${subCompletedCount}/${sub.chapters.length}</span>
                 </div>
              </div>
              <svg class="arrow w-5 h-5 text-gray-400 transition-transform duration-300 transform rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
            </div>
            <div class="">
               <div class="p-2 grid grid-cols-1 md:grid-cols-2 gap-0">
                 ${chaptersHtml}
               </div>
            </div>
          </div>
        `;
      });

      container.innerHTML = html;
      updateTrackerDashboard(selectedYear, completedChapters, totalChapters);
    }

    function toggleChapter(id) {
      const completedSet = new Set(JSON.parse(localStorage.getItem(LS_KEY_SYLLABUS)) || []);
      if (completedSet.has(id)) completedSet.delete(id);
      else completedSet.add(id);
      localStorage.setItem(LS_KEY_SYLLABUS, JSON.stringify([...completedSet]));
      const yearFilter = document.getElementById('tracker-year-filter');
      renderTrackerList(yearFilter.value);
    }

    function updateTrackerDashboard(year, completed, total) {
      const percentage = total === 0 ? 0 : Math.round((completed / total) * 100);
      const bnYear = year === '1st Year' ? 'рззржо ржмрж░рзНрж╖рзЗрж░' : year === '2nd Year' ? 'рзирзЯ ржмрж░рзНрж╖рзЗрж░' : year === '3rd Year' ? 'рзйрзЯ ржмрж░рзНрж╖рзЗрж░' : year === '4th Year' ? 'рзкрж░рзНрже ржмрж░рзНрж╖рзЗрж░' : 'ржЕржирзНржпрж╛ржирзНржп';
      document.getElementById('tracker-summary-text').textContent = `ржЖржкржирж╛рж░ ${bnYear} ржкрзНрж░рж╕рзНрждрзБрждрж┐ рж╕ржорзНржкржирзНржи рж╣рзЯрзЗржЫрзЗ`;
      document.getElementById('tracker-percent').textContent = `${percentage}%`;
      document.getElementById('tracker-progress-bar').style.width = `${percentage}%`;
    }

    // --- Render Logic (Card Design) ---
    function renderCard(q, index, type) {
       let badges = ``;
       if (q.importance === 'High') badges += `<span class="bg-yellow-100 text-yellow-700 text-xs px-2 py-0.5 rounded-full font-bold flex items-center gap-1">тЪб High Priority</span>`;
       if (q.difficulty) badges += `<span class="bg-gray-100 text-gray-600 text-xs px-2 py-0.5 rounded-full">${q.difficulty}</span>`;
       
       const isSaved = (JSON.parse(localStorage.getItem(LS_KEY_SAVED))||[]).some(sq => sq.question === q.question);
       const btnClass = isSaved ? 'bg-green-100 text-green-700' : 'bg-gray-100 hover:bg-gray-200 text-gray-600';
       const btnIcon = isSaved ? 
         `<svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path></svg>` : 
         `<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z"></path></svg>`;

       let optionsHtml = '';
       if(q.type === 'MCQ' && q.options) {
         optionsHtml = `<div class="grid grid-cols-1 md:grid-cols-2 gap-2 mt-3">
           ${q.options.map(opt => `
             <div class="p-3 rounded-lg border border-gray-100 text-sm ${opt === q.correct_answer ? 'bg-green-50 border-green-200 text-green-800 font-medium' : 'bg-gray-50 text-gray-600'}">
               ${opt} ${opt === q.correct_answer ? 'тЬЕ' : ''}
             </div>
           `).join('')}
         </div>`;
       }
       return `
         <div class="bg-white rounded-2xl p-5 md:p-6 shadow-sm hover:shadow-md transition-shadow duration-300 border border-primary-50 relative group animate-fade-in card">
           <div class="flex justify-between items-start gap-4 mb-3">
             <div class="flex-1">
               <div class="flex flex-wrap gap-2 mb-2">
                 <span class="text-xs font-bold text-primary-600 uppercase tracking-wider">ржкрзНрж░рж╢рзНржи ${index+1}</span>
                 ${badges}
               </div>
               <h3 class="text-lg md:text-xl font-content font-medium text-gray-800 leading-relaxed">${q.question}</h3>
             </div>
             <button onclick="${type === 'saved' ? `removeSavedQuestion(this, ${index})` : 'saveQuestion(this)'}" 
                     data-question='${JSON.stringify(q).replace(/'/g, "&#39;")}'
                     class="p-2 rounded-xl transition-all ${type === 'saved' ? 'bg-red-50 text-red-500 hover:bg-red-100' : btnClass}" 
                     title="${type === 'saved' ? 'Remove' : 'Save'}">
                ${type === 'saved' ? '<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg>' : btnIcon}
             </button>
           </div>
           ${optionsHtml}
           <div class="mt-4 pt-4 border-t border-gray-50 flex items-center justify-between">
             <button onclick="toggleAnswer(this)" class="text-sm font-semibold text-primary-600 hover:text-primary-700 flex items-center gap-1 focus:outline-none">
               <span>ржЙрждрзНрждрж░ ржжрзЗржЦрзБржи</span>
               <svg class="w-4 h-4 transition-transform transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
             </button>
             <div class="flex gap-2 items-center">
               <button onclick="askAiQuestion('${q.question}')" class="text-xs flex items-center gap-1 bg-gradient-to-r from-primary-500 to-primary-600 text-white px-2 py-1 rounded-md hover:shadow-md transition-all">
                 <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg>
                 AI Ask
               </button>
               <span class="text-xs text-gray-400 bg-gray-50 px-2 py-1 rounded-md">${q.type}</span>
             </div>
           </div>
           <div class="answer-content mt-2 bg-slate-50 rounded-xl">
             <div class="p-4 text-gray-700 text-sm md:text-base leading-relaxed font-content">
               <div class="flex justify-between mb-2">
                 <strong class="text-gray-900 block">ржоржбрзЗрж▓ ржЙрждрзНрждрж░:</strong>
                 <button class="text-xs text-gray-400 hover:text-primary-600 copy-btn">Copy</button>
               </div>
               <div class="whitespace-pre-wrap answer-text">${q.model_answer || 'N/A'}</div>
               <div class="mt-3 text-xs text-gray-500 pt-2 border-t border-gray-200">
                 <span class="font-bold">рждржерзНржпрж╕рзВрждрзНрж░:</span> ${q.references ? q.references.join(', ') : 'N/A'}
               </div>
             </div>
           </div>
         </div>
       `;
    }

    function toggleAnswer(btn) {
      const content = btn.parentElement.nextElementSibling;
      const arrow = btn.querySelector('svg');
      const isShow = content.classList.contains('show');
      if(isShow) {
        content.classList.remove('show'); btn.querySelector('span').textContent = 'ржЙрждрзНрждрж░ ржжрзЗржЦрзБржи'; arrow.classList.remove('rotate-180');
      } else {
        content.classList.add('show'); btn.querySelector('span').textContent = 'ржЙрждрзНрждрж░ рж▓рзБржХрж╛ржи'; arrow.classList.add('rotate-180');
      }
    }

    function renderQuestions(questions, containerId) {
      const container = document.getElementById(containerId);
      if(!questions || !questions.length) return;
      container.innerHTML = questions.map((q, i) => renderCard(q, i, containerId === 'collection-container' ? 'saved' : 'gen')).join('');
      container.querySelectorAll('.copy-btn').forEach(btn => {
        btn.addEventListener('click', (e) => {
          const text = e.target.closest('.answer-content').querySelector('.answer-text').innerText; copyToClipboard(text);
        });
      });
      if(containerId === 'result-container') localStorage.setItem(LS_KEY_QUESTION_GEN, container.innerHTML);
    }

    function saveQuestion(btn) {
      try {
        const q = JSON.parse(btn.getAttribute('data-question'));
        let saved = JSON.parse(localStorage.getItem(LS_KEY_SAVED)) || [];
        if(!saved.some(sq => sq.question === q.question)) {
          saved.push(q); localStorage.setItem(LS_KEY_SAVED, JSON.stringify(saved));
          updateSavedCountBadge(); toast('ржкрзНрж░рж╢рзНржиржЯрж┐ рж╕ржВржЧрзНрж░рж╣рзЗ рж░рж╛ржЦрж╛ рж╣рзЯрзЗржЫрзЗ', 'success');
          btn.innerHTML = `<svg class="w-5 h-5 text-green-600" fill="currentColor" viewBox="0 0 20 20"><path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"></path></svg>`;
          btn.classList.remove('bg-gray-100', 'text-gray-600'); btn.classList.add('bg-green-100', 'text-green-600');
        } else { toast('ржЗрждрж┐ржоржзрзНржпрзЗ рж╕ржВржЧрзНрж░рж╣рзЗ ржЖржЫрзЗ', 'info'); }
      } catch(e) { console.error(e); }
    }

    function removeSavedQuestion(btn, index) {
      let saved = JSON.parse(localStorage.getItem(LS_KEY_SAVED)) || [];
      saved.splice(index, 1); localStorage.setItem(LS_KEY_SAVED, JSON.stringify(saved));
      renderSavedQuestions(); toast('ржорзБржЫрзЗ ржлрзЗрж▓рж╛ рж╣рзЯрзЗржЫрзЗ', 'success');
    }

    function renderSavedQuestions() {
      const saved = JSON.parse(localStorage.getItem(LS_KEY_SAVED)) || [];
      updateSavedCountBadge();
      if(!saved.length) {
        collectionContainer.innerHTML = `<div class="text-center py-10 text-gray-400"><div class="bg-primary-50 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-3"><svg class="w-8 h-8 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"></path></svg></div><p>ржЖржкржирж╛рж░ рж╕ржВржЧрзНрж░рж╣рзЗ ржХрзЛржирзЛ ржкрзНрж░рж╢рзНржи ржирзЗржЗ</p></div>`;
        return;
      }
      renderQuestions(saved, 'collection-container');
    }

    // --- PDF Download Functionality (UPDATED HIGH QUALITY A4 & NO CUTTING) ---
    document.getElementById('download-pdf-btn').addEventListener('click', () => {
        const element = document.getElementById('collection-container');
        const saved = JSON.parse(localStorage.getItem(LS_KEY_SAVED)) || [];
        
        if (!saved.length) {
            toast('ржбрж╛ржЙржирж▓рзЛржб ржХрж░рж╛рж░ ржЬржирзНржп ржХрзЛржирзЛ ржкрзНрж░рж╢рзНржи ржирзЗржЗ', 'info');
            return;
        }

        toast('PDF рждрзИрж░рж┐ рж╣ржЪрзНржЫрзЗ... ржЕржирзБржЧрзНрж░рж╣ ржХрж░рзЗ ржЕржкрзЗржХрзНрж╖рж╛ ржХрж░рзБржи', 'info');

        // Temporarily expand all answers and adjust styles for printing
        const answers = element.querySelectorAll('.answer-content');
        answers.forEach(el => {
            el.classList.add('show');
            el.style.maxHeight = 'none'; 
            el.parentElement.style.color = '#000000'; // Ensure high contrast
        });

        const opt = {
            margin:       0.5,
            filename:     'NU_Smart_Question_Bank.pdf',
            image:        { type: 'jpeg', quality: 0.98 },
            // Scale reduced to 2 for better stability, but still high quality for print
            html2canvas:  { scale: 2, useCORS: true, scrollY: 0 },
            jsPDF:        { unit: 'in', format: 'a4', orientation: 'portrait' },
            // Important: This prevents text cutting
            pagebreak:    { mode: ['avoid-all', 'css', 'legacy'] } 
        };

        html2pdf().set(opt).from(element).save().then(() => {
            // Restore original state
            answers.forEach(el => {
                el.classList.remove('show');
                el.style.maxHeight = null; 
                el.parentElement.style.color = '';
            });
            toast('PDF ржбрж╛ржЙржирж▓рзЛржб рж╕ржорзНржкржирзНржи рж╣рзЯрзЗржЫрзЗ', 'success');
        });
    });

    document.getElementById('export-csv-btn').addEventListener('click', () => {
      const saved = JSON.parse(localStorage.getItem(LS_KEY_SAVED)) || [];
      if (!saved.length) return toast('рж░ржкрзНрждрж╛ржирж┐рж░ ржЬржирзНржп ржХрж┐ржЫрзБ ржирзЗржЗ', 'info');
      const csvContent = "data:text/csv;charset=utf-8," + "Question,Type,Answer\n" + saved.map(e => `"${e.question.replace(/"/g, '""')}","${e.type}","${(e.model_answer||'').replace(/"/g, '""')}"`).join("\n");
      const encodedUri = encodeURI(csvContent);
      const link = document.createElement("a"); link.setAttribute("href", encodedUri); link.setAttribute("download", "my_questions.csv"); document.body.appendChild(link); link.click(); document.body.removeChild(link);
    });
    document.getElementById('clear-all-btn').addEventListener('click', () => {
      if(confirm('ржЖржкржирж┐ ржХрж┐ ржирж┐рж╢рзНржЪрж┐ржд ржпрзЗ рж╕ржм ржорзБржЫрзЗ ржлрзЗрж▓рждрзЗ ржЪрж╛ржи?')) { localStorage.removeItem(LS_KEY_SAVED); renderSavedQuestions(); toast('рж╕ржм ржорзБржЫрзЗ ржлрзЗрж▓рж╛ рж╣рзЯрзЗржЫрзЗ', 'success'); }
    });

    // --- AI Prompts (Robust Version) ---
    function getAiPrompt(subject, chapter, topic, type, count) {
      let qType = (type === 'Mixed') ? `Generate ${count} questions. Create a mix of question types (MCQ, Short Answer, Long Answer).` : `Generate ${count} ${type} questions.`;
      return `
You are an expert academic assistant for National University (NU), Bangladesh.
Subject: ${subject}
Chapter: ${chapter}
Task: ${qType}

Generate a structured JSON output. The root must be a JSON object containing a single key "questions", which is a list of question objects.
DO NOT output markdown. Output ONLY raw JSON.

Structure per question:
{
  "question": "Question text in Bengali",
  "type": "MCQ | Short | Long",
  "difficulty": "Easy | Medium | Hard",
  "importance": "High | Medium | Low",
  "options": ["Option A", "Option B", "Option C", "Option D"] (Only for MCQ),
  "correct_answer": "Option B" (Only for MCQ),
  "model_answer": "Detailed model answer in Bengali",
  "references": ["Previous Year Question", "Textbook"]
}
`;
    }

    // --- AI Action Listeners ---
    generateBtn.addEventListener('click', async () => {
      const sub = subjectSelect.value; const chap = chapterSelect.value;
      if(!sub || !chap) return toast('ржмрж┐рж╖рзЯ ржУ ржЕржзрзНржпрж╛рзЯ ржирж┐рж░рзНржмрж╛ржЪржи ржХрж░рзБржи', 'error');
      
      btnText.textContent = 'рждрзИрж░рж┐ рж╣ржЪрзНржЫрзЗ...'; loader.classList.remove('hidden'); generateBtn.disabled = true;
      resultContainer.innerHTML = `<div class="flex justify-center py-12"><div class="dots-loader"><div class="dot1"></div><div class="dot2"></div><div class="dot3"></div></div></div>`;
      
      try {
        const prompt = getAiPrompt(sub, chap, chap, document.getElementById('type').value, document.getElementById('question-count').value);
        const res = await fetchWithRetry(apiUrl, {
          method: 'POST', headers: {'Content-Type': 'application/json'},
          body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] })
        });
        const data = await res.json();
        const text = data.candidates?.[0]?.content?.parts?.[0]?.text || '';
        const cleaned = text.replace(/```json/g, '').replace(/```/g, '').trim();
        const json = JSON.parse(cleaned);
        renderQuestions(json.questions, 'result-container');
        toast('ржкрзНрж░рж╢рзНржи рждрзИрж░рж┐ рж╕ржорзНржкржирзНржи!', 'success');
      } catch(e) {
        console.error(e);
        resultContainer.innerHTML = `<div class="text-red-500 text-center p-4">ржжрзБржГржЦрж┐ржд, ржХрзЛржирзЛ рждрзНрж░рзБржЯрж┐ рж╣рзЯрзЗржЫрзЗред (${e.message})</div>`;
        toast('рждрзНрж░рзБржЯрж┐ рж╣рзЯрзЗржЫрзЗ', 'error');
      } finally {
        btnText.textContent = 'ржкрзНрж░рж╢рзНржи ржЬрзЗржирж╛рж░рзЗржЯ ржХрж░рзБржи'; loader.classList.add('hidden'); generateBtn.disabled = false;
      }
    });

    // --- Chat Widget Logic (Updated with Memory & Persona) ---
    const chatFab = document.getElementById('chat-fab');
    const chatWidget = document.getElementById('chat-widget');
    const closeChatBtn = document.getElementById('close-chat-btn');
    const sendMsgBtn = document.getElementById('send-msg-btn');
    const chatInput = document.getElementById('chat-input');
    const chatBody = document.getElementById('chat-body');

    // Conversation History Storage
    let chatHistory = [];

    // System Instruction with Persona & Academic Rules
    const systemPromptText = `
ржЖржкржирж┐ ржЬрж╛рждрзАрзЯ ржмрж┐рж╢рзНржмржмрж┐ржжрзНржпрж╛рж▓рзЯ (NU), ржмрж╛ржВрж▓рж╛ржжрзЗрж╢рзЗрж░ рж╕ржорж╛ржЬржХрж░рзНржо ржмрж┐ржнрж╛ржЧрзЗрж░ рж╢рж┐ржХрзНрж╖рж╛рж░рзНржерзАржжрзЗрж░ ржЬржирзНржп ржПржХржЯрж┐ ржжржХрзНрж╖ 'AI рж╕рзНржЯрж╛ржбрж┐ ржЕрзНржпрж╛рж╕рж┐рж╕рзНржЯрзНржпрж╛ржирзНржЯ'ред рж╕рж░рзНржмржжрж╛ ржмрж╛ржВрж▓рж╛рзЯ ржЙрждрзНрждрж░ ржжрж┐ржмрзЗржиред

***ржмрзНржпржХрзНрждрж┐рждрзНржм ржУ ржкрж░рж┐ржЪрзЯ ржирж┐рж░рзНржжрзЗрж╢рж╛ржмрж▓рзА (Persona Rules) - ржЧрзБрж░рзБрждрзНржм рж╕рж╣ржХрж╛рж░рзЗ ржкрж╛рж▓ржи ржХрж░рзБржи:***
рзз. ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА ржпржжрж┐ ржкрзНрж░рж╢рзНржи ржХрж░рзЗ ржЖржкржирж╛ржХрзЗ ржХрзЗ рждрзИрж░рж┐ ржХрж░рзЗржЫрзЗ ржмрж╛ ржЖржкржирж╛рж░ ржирж┐рж░рзНржорж╛рждрж╛ ржХрзЗ (Who created you?), рждржмрзЗ ржарж┐ржХ ржПржЗ ржЙрждрзНрждрж░ржЯрж┐ ржжрж┐ржмрзЗржи:
   "ржЖржорж╛ржХрзЗ рж╢рж╛рж╣рж╛ржжрзО рж╣рзЛрж╕рзЗржи ржирж╛ржорзЗ ржПржХржЬржи рж╢рж┐ржХрзНрж╖рж╛рж░рзНржерзА рждрзИрж░рж┐ ржХрж░рзЗржЫрзЗржиред ржЖржкржирж┐ ржХрж┐ рждрж╛рж░ рж╕рж╛ржерзЗ ржпрзЛржЧрж╛ржпрзЛржЧ ржХрж░рждрзЗ ржЪрж╛ржи?"
рзи. ржпржжрж┐ ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА ржпрзЛржЧрж╛ржпрзЛржЧ ржХрж░рждрзЗ ржЪрж╛рзЯ ржмрж╛ 'рж╣рзНржпрж╛ржБ' (Yes) ржмрж▓рзЗ, рждржмрзЗржЗ ржПржЗ ржлрзЛржи ржирж╛ржорзНржмрж╛рж░ржЯрж┐ ржжрж┐ржмрзЗржи: **01760750263**ред
рзй. ржпржжрж┐ ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА ржпрзЛржЧрж╛ржпрзЛржЧ ржХрж░рждрзЗ ржирж╛ ржЪрж╛рзЯ, рждржмрзЗ ржЕржирзНржп ржкрзНрж░рж╕ржЩрзНржЧрзЗ ржЪрж▓рзЗ ржпрж╛ржмрзЗржиред

***ржЕрзНржпрж╛ржХрж╛ржбрзЗржорж┐ржХ ржирж┐рж░рзНржжрзЗрж╢рж╛ржмрж▓рзА:***
ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзАрж░ ржЗржиржкрзБржЯ ржмрж┐рж╢рзНрж▓рзЗрж╖ржг ржХрж░рзБржиред ржпржжрж┐ ржПржЯрж┐ рж╕рж╛ржзрж╛рж░ржг ржХрзБрж╢рж▓ ржмрж┐ржирж┐ржорзЯ рж╣рзЯ, рж╕рзНржмрж╛ржнрж╛ржмрж┐ржХ ржЙрждрзНрждрж░ ржжрж┐ржиред ржпржжрж┐ ржПржЯрж┐ ржЕрзНржпрж╛ржХрж╛ржбрзЗржорж┐ржХ ржкрзНрж░рж╢рзНржи рж╣рзЯ, рждржмрзЗ ржирж┐ржЪрзЗрж░ ржирж┐рзЯржо ржорж╛ржирзБржи:

рзз. ржЬрзНржЮрж╛ржиржорзВрж▓ржХ ржкрзНрж░рж╢рзНржи (Knowledge-based):
- рж╕ржВржЬрзНржЮрж╛ ржУ рждржерзНржп рж╕рж░рж╛рж╕рж░рж┐ ржжрж┐ржиред ржкрзЯрзЗржирзНржЯ ржЖржХрж╛рж░рзЗ ржЫрзЛржЯ ржмрж╛ржХрзНржпрзЗ рж╕рж╛ржЬрж╛ржиред ржПржХржЯрж┐ ржЫрзЛржЯ ржЙржжрж╛рж╣рж░ржг ржжрж┐ржиред

рзи. ржЕржирзБржзрж╛ржмржи/рж╕ржВржХрзНрж╖рж┐ржкрзНржд ржкрзНрж░рж╢рзНржи (Short):
- ржнрзВржорж┐ржХрж╛: рззтАУрзи рж▓рж╛ржЗржирзЗред ржорзВрж▓ ржЖрж▓рзЛржЪржирж╛: рзйтАУрзкржЯрж┐ ржкрзЯрзЗржирзНржЯрзЗред ржорзЛржЯ рзотАУрззрзж рж▓рж╛ржЗржиред

рзй. рж░ржЪржирж╛ржорзВрж▓ржХ/рж▓ржорзНржмрж╛ ржкрзНрж░рж╢рзНржи (Long):
- ржнрзВржорж┐ржХрж╛: рзктАУрзл рж▓рж╛ржЗржиред ржорзВрж▓ ржЕржВрж╢: рзлтАУрзнржЯрж┐ ржкрзЯрзЗржирзНржЯрзЗ ржмрж┐рж╕рзНрждрж╛рж░рж┐ржд (рждрждрзНрждрзНржм ржУ ржЙржжрж╛рж╣рж░ржгрж╕рж╣)ред ржЙржкрж╕ржВрж╣рж╛рж░: рзитАУрзй рж▓рж╛ржЗржиред рж╢рж┐рж░рзЛржирж╛ржо ржУ ржмрзБрж▓рзЗржЯ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзБржиред

рзк. рж╕рж╛ржзрж╛рж░ржг ржирж┐рж░рзНржжрзЗрж╢ржирж╛:
- ржкрзНрж░рж╢рзНржирзЗрж░ ржХрзАржУржпрж╝рж╛рж░рзНржб ржЖржирзНржбрж╛рж░рж▓рж╛ржЗржи ржмрж╛ Bold ржХрж░рзБржиред ржмрж╛ржВрж▓рж╛ржжрзЗрж╢рж┐ ржкрзНрж░рзЗржХрзНрж╖рж╛ржкржЯ ржУ ржЙржжрж╛рж╣рж░ржг ржжрж┐ржиред
`;

    // New Function to Ask AI Directly
    function askAiQuestion(questionText) {
        // Force open chat if closed
        const isClosed = chatWidget.classList.contains('chat-closed');
        if (isClosed) {
            toggleChat();
        }
        
        // Prepare prompt
        const prompt = `ржПржЗ ржкрзНрж░рж╢рзНржиржЯрж┐ ржмрж┐рж╕рзНрждрж╛рж░рж┐ржд ржмрзБржЭрж┐рзЯрзЗ ржмрж▓: "${questionText}"`;
        chatInput.value = prompt;
        
        // Small delay to ensure UI updates before sending
        setTimeout(() => {
            handleSend();
        }, 300);
    }

    function toggleChat() {
      const isClosed = chatWidget.classList.contains('chat-closed');
      if (isClosed) { 
          chatWidget.classList.remove('chat-closed'); 
          chatWidget.classList.add('chat-open'); 
          if(window.innerWidth < 768) document.body.style.overflow = 'hidden';
          setTimeout(() => chatInput.focus(), 100); 
      } 
      else { 
          chatWidget.classList.remove('chat-open'); 
          chatWidget.classList.add('chat-closed'); 
          document.body.style.overflow = '';
      }
    }
    chatFab.addEventListener('click', toggleChat);
    closeChatBtn.addEventListener('click', toggleChat);

    function appendMessage(text, sender) {
      const div = document.createElement('div');
      div.className = `flex gap-3 items-start ${sender === 'user' ? 'flex-row-reverse' : ''}`;
      const avatar = sender === 'ai' 
        ? `<div class="w-8 h-8 rounded-full bg-primary-100 border border-primary-200 flex items-center justify-center text-primary-600 text-xs font-bold flex-shrink-0">AI</div>`
        : `<div class="w-8 h-8 rounded-full bg-gray-200 flex items-center justify-center text-gray-600 text-xs font-bold flex-shrink-0">ME</div>`;
      const bubbleClass = sender === 'ai' 
        ? 'bg-white text-gray-700 border border-gray-100 rounded-2xl rounded-tl-none chat-bubble-ai' 
        : 'bg-primary-600 text-white rounded-2xl rounded-tr-none shadow-md';
      
      let formattedText = text;
      if (sender === 'ai') {
        formattedText = formattedText.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
        formattedText = formattedText.replace(/\n/g, '<br>');
      }

      div.innerHTML = `${avatar}<div class="${bubbleClass} p-3.5 shadow-sm text-sm leading-relaxed max-w-[80%]">${formattedText}</div>`;
      chatBody.appendChild(div); chatBody.scrollTop = chatBody.scrollHeight;
    }

    function appendLoading() {
      const div = document.createElement('div'); div.id = 'chat-loading'; div.className = 'flex gap-3 items-start';
      div.innerHTML = `<div class="w-8 h-8 rounded-full bg-primary-100 border border-primary-200 flex items-center justify-center text-primary-600 text-xs font-bold flex-shrink-0">AI</div><div class="bg-white p-3.5 rounded-2xl rounded-tl-none shadow-sm border border-gray-100 flex items-center h-10"><div class="typing-dot"></div><div class="typing-dot"></div><div class="typing-dot"></div></div>`;
      chatBody.appendChild(div); chatBody.scrollTop = chatBody.scrollHeight;
    }
    function removeLoading() { document.getElementById('chat-loading')?.remove(); }

    async function handleSend() {
      const text = chatInput.value.trim(); if (!text) return;
      
      // 1. Display User Message
      appendMessage(text, 'user'); 
      chatInput.value = ''; 
      appendLoading();

      // 2. Update History
      chatHistory.push({ role: "user", parts: [{ text: text }] });

      try {
        // 3. Send History + System Instruction to API
        const payload = {
            contents: chatHistory,
            systemInstruction: {
                parts: [{ text: systemPromptText }]
            }
        };

        const res = await fetchWithRetry(apiUrl, {
          method: 'POST', 
          headers: {'Content-Type': 'application/json'},
          body: JSON.stringify(payload)
        });
        
        const data = await res.json();
        const reply = data.candidates?.[0]?.content?.parts?.[0]?.text || 'ржжрзБржГржЦрж┐ржд, ржЙрждрзНрждрж░ ржжрзЗржУрзЯрж╛ рж╕ржорзНржнржм рж╣ржЪрзНржЫрзЗ ржирж╛ред';
        
        // 4. Update History with Model Response
        chatHistory.push({ role: "model", parts: [{ text: reply }] });

        // 5. Display AI Response
        removeLoading(); 
        appendMessage(reply, 'ai');

      } catch (e) {
        removeLoading(); 
        appendMessage("ржжрзБржГржЦрж┐ржд, ржПржХржЯрж┐ рждрзНрж░рзБржЯрж┐ рж╣рзЯрзЗржЫрзЗред", 'ai'); 
        console.error(e);
        // Remove failed user message from history to prevent sync issues
        chatHistory.pop();
      }
    }

    sendMsgBtn.addEventListener('click', handleSend);
    chatInput.addEventListener('keydown', (e) => { if(e.key === 'Enter') handleSend(); });

    if (window.visualViewport) {
        window.visualViewport.addEventListener('resize', () => {
            if (!document.getElementById('chat-widget').classList.contains('chat-closed')) {
                chatBody.scrollTop = chatBody.scrollHeight;
            }
        });
    }
  </script>
</body>
</html>

